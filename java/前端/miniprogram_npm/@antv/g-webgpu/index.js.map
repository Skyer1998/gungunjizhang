{"version":3,"sources":["index.js","camera/Camera.js","utils/math.js","utils/is-number.js","camera/Landmark.js","geometry/index.js","Kernel.js","utils/canvas.js","utils/is-array.js","utils/is-type.js","utils/is-typedarray.js","material/index.js","renderable/Renderable.js","World.js","geometry/Box.js","geometry/Merged.js","utils/typedarray.js","geometry/Plane.js","geometry/Sphere.js","material/basic/index.js","renderable/grid/index.js","renderable/line/index.js","utils/polyline-normals.js","renderable/point/index.js","utils/picking.js","Renderer.js","Scene.js","texture/Cache.js","texture/Texture2D.js","View.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AGTA,ADGA;ADIA,ADGA,AGTA,ADGA;ADIA,ADGA,AGTA,ADGA;ADIA,AGTA,AJYA,AGTA,ADGA;ADIA,AGTA,AJYA,AGTA,ADGA;ADIA,AGTA,AJYA,AGTA,ADGA;ADIA,AGTA,ACHA,ALeA,AGTA,ADGA;ADIA,AGTA,ACHA,ALeA,AGTA,ADGA;ADIA,AGTA,ACHA,ALeA,AGTA,ADGA;AIXA,ALeA,AGTA,ACHA,ALeA,AGTA,ADGA;AIXA,ALeA,AGTA,ACHA,ALeA,AGTA,ADGA;AIXA,ALeA,AGTA,ACHA,ALeA,AENA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ALeA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ALeA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ALeA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ACHA,ANkBA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ACHA,ANkBA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ACHA,ANkBA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ACHA,ACHA,APqBA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ACHA,ACHA,APqBA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ACHA,ACHA,APqBA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ACHA,ACHA,ACHA,ARwBA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ACHA,ACHA,ACHA,ARwBA;AIXA,ALeA,AGTA,ACHA,ALeA,AOrBA,ACHA,ACHA,ACHA,ARwBA;AIXA,ALeA,AGTA,ACHA,ALeA,AWjCA,AJYA,ACHA,ACHA,ACHA,ARwBA;AIXA,ALeA,AGTA,ACHA,ALeA,AWjCA,AJYA,ACHA,ACHA,ACHA,ARwBA;AIXA,ALeA,AGTA,ACHA,ALeA,AWjCA,AJYA,ACHA,ACHA,ACHA,ARwBA;AIXA,ALeA,AGTA,ACHA,ALeA,AWjCA,ACHA,AJYA,ACHA,ACHA,ARwBA;AIXA,ALeA,AGTA,ACHA,ALeA,AWjCA,ACHA,AJYA,ACHA,ACHA,ARwBA;AIXA,ALeA,AGTA,ACHA,ALeA,AWjCA,ACHA,AJYA,ACHA,ACHA,ARwBA;AIXA,AOrBA,AZoCA,AGTA,ACHA,ALeA,AWjCA,ACHA,AJYA,ACHA,ACHA,ARwBA;AIXA,AOrBA,AZoCA,AGTA,ACHA,ALeA,AWjCA,ACHA,AJYA,ACHA,ACHA,ARwBA;AIXA,AOrBA,AZoCA,AGTA,ACHA,ALeA,AWjCA,ACHA,AHSA,ACHA;AJaA,AOrBA,AZoCA,AGTA,AU9BA,AT2BA,ALeA,AWjCA,ACHA,AFMA;AJaA,AOrBA,AZoCA,AGTA,AU9BA,AT2BA,ALeA,AWjCA,ACHA,AFMA;AJaA,AOrBA,AZoCA,AGTA,AU9BA,AT2BA,ALeA,AWjCA,ACHA,AFMA;AJaA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AV8BA,ALeA,AWjCA,ACHA,AFMA;AJaA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AV8BA,ALeA,AWjCA,ACHA,AFMA;AJaA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AV8BA,ALeA,AWjCA,ACHA,AFMA;AJaA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AV8BA,ALeA,AWjCA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AV8BA,ALeA,AWjCA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AV8BA,ALeA,AWjCA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,AZoCA,ALeA,AWjCA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,AZoCA,ALeA,AWjCA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,AZoCA,ALeA,AWjCA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,AMlBA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,AMlBA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,AMlBA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AFMA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,AV8BA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,AV8BA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,AV8BA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AXiCA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AXiCA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AXiCA,AMlBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AXiCA,AYpCA,ANkBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AXiCA,AYpCA,ANkBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AXiCA,AYpCA,ANkBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,AYpCA,ANkBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,AYpCA,ANkBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,AYpCA,ANkBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,Ac1CA,AFMA,ANkBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,Ac1CA,AFMA,ANkBA;AV+BA,AOrBA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,Ac1CA,AFMA,ANkBA;AV+BA,AmBzDA,AZoCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,Ac1CA,AFMA,ANkBA;AV+BA,AmBzDA,AZoCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,Ac1CA,AFMA,ANkBA;AV+BA,AmBzDA,AZoCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,Ac1CA,AFMA,ANkBA;AV+BA,AmBzDA,ACHA,AbuCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,Ac1CA,AFMA,ANkBA;AV+BA,AmBzDA,ACHA,AbuCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,Ac1CA,AFMA,ANkBA;AV+BA,AmBzDA,ACHA,AbuCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AbuCA,Ac1CA,AFMA,ANkBA;AV+BA,AmBzDA,ACHA,AbuCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,AjBmDA,Ac1CA,AFMA,ANkBA;AV+BA,AmBzDA,ACHA,AbuCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,AjBmDA,Ac1CA,AFMA,ANkBA;AV+BA,AmBzDA,ACHA,AbuCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,AjBmDA,AYpCA,ANkBA;AV+BA,AmBzDA,ACHA,AbuCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AbuCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,AbuCA,Ac1CA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AbuCA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,ARwBA,ACHA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AGTA,AU9BA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AIZA,ACHA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,AlBsDA,AYpCA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,ACHA,AGTA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,ACHA,AENA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AGTA,ACHA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AIZA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AIZA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AIZA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AIZA,ACHA,APqBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AIZA,ANkBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AIZA,ANkBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AIZA,ANkBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AIZA,AhBgDA,AZoCA,AavCA,AIZA,ANkBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AIZA,ANkBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AIZA,ANkBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AIZA,ANkBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AIZA,ANkBA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA,ANkBA;AhBiDA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AQxBA,ACHA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AS3BA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AS3BA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AS3BA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AS3BA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AS3BA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AFMA,AS3BA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA,AKfA;AtBmEA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AavCA,AOrBA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AoB5DA,AENA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA,AsBlEA;AjBoDA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AZoCA,AZoCA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AKdA,AmBzDA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AwBvEA,AxBwEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"Camera\", {\n  enumerable: true,\n  get: function get() {\n    return _Camera.Camera;\n  }\n});\nObject.defineProperty(exports, \"Geometry\", {\n  enumerable: true,\n  get: function get() {\n    return _geometry.Geometry;\n  }\n});\nObject.defineProperty(exports, \"Kernel\", {\n  enumerable: true,\n  get: function get() {\n    return _Kernel.Kernel;\n  }\n});\nObject.defineProperty(exports, \"Material\", {\n  enumerable: true,\n  get: function get() {\n    return _material.Material;\n  }\n});\nObject.defineProperty(exports, \"Renderable\", {\n  enumerable: true,\n  get: function get() {\n    return _Renderable.Renderable;\n  }\n});\nObject.defineProperty(exports, \"World\", {\n  enumerable: true,\n  get: function get() {\n    return _World.World;\n  }\n});\n\nvar _Camera = require(\"./camera/Camera\");\n\nvar _geometry = require(\"./geometry\");\n\nvar _Kernel = require(\"./Kernel\");\n\nvar _material = require(\"./material\");\n\nvar _Renderable = require(\"./renderable/Renderable\");\n\nvar _World = require(\"./World\");\n//# sourceMappingURL=index.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Camera = exports.CAMERA_PROJECTION_MODE = exports.CAMERA_TRACKING_MODE = exports.CAMERA_TYPE = void 0;\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _glMatrix = require(\"gl-matrix\");\n\nvar _inversify = require(\"inversify\");\n\nvar _math = require(\"../utils/math\");\n\nvar _Landmark = _interopRequireDefault(require(\"./Landmark\"));\n\nvar _dec, _dec2, _class, _class2, _descriptor, _class3, _temp;\n\nvar CAMERA_TYPE;\nexports.CAMERA_TYPE = CAMERA_TYPE;\n\n(function (CAMERA_TYPE) {\n  CAMERA_TYPE[\"ORBITING\"] = \"ORBITING\";\n  CAMERA_TYPE[\"EXPLORING\"] = \"EXPLORING\";\n  CAMERA_TYPE[\"TRACKING\"] = \"TRACKING\";\n})(CAMERA_TYPE || (exports.CAMERA_TYPE = CAMERA_TYPE = {}));\n\nvar CAMERA_TRACKING_MODE;\nexports.CAMERA_TRACKING_MODE = CAMERA_TRACKING_MODE;\n\n(function (CAMERA_TRACKING_MODE) {\n  CAMERA_TRACKING_MODE[\"DEFAULT\"] = \"DEFAULT\";\n  CAMERA_TRACKING_MODE[\"ROTATIONAL\"] = \"ROTATIONAL\";\n  CAMERA_TRACKING_MODE[\"TRANSLATIONAL\"] = \"TRANSLATIONAL\";\n  CAMERA_TRACKING_MODE[\"CINEMATIC\"] = \"CINEMATIC\";\n})(CAMERA_TRACKING_MODE || (exports.CAMERA_TRACKING_MODE = CAMERA_TRACKING_MODE = {}));\n\nvar CAMERA_PROJECTION_MODE;\nexports.CAMERA_PROJECTION_MODE = CAMERA_PROJECTION_MODE;\n\n(function (CAMERA_PROJECTION_MODE) {\n  CAMERA_PROJECTION_MODE[\"ORTHOGRAPHIC\"] = \"ORTHOGRAPHIC\";\n  CAMERA_PROJECTION_MODE[\"PERSPECTIVE\"] = \"PERSPECTIVE\";\n})(CAMERA_PROJECTION_MODE || (exports.CAMERA_PROJECTION_MODE = CAMERA_PROJECTION_MODE = {}));\n\nvar DEG_2_RAD = Math.PI / 180;\nvar RAD_2_DEG = 180 / Math.PI;\n/**\n * 参考「WebGL Insights - 23.Designing Cameras for WebGL Applications」，基于 Responsible Camera 思路设计\n * 保存相机参数，定义相机动作：\n * 1. dolly 沿 n 轴移动\n * 2. pan 沿 u v 轴移动\n * 3. rotate 以方位角旋转\n * 4. 移动到 Landmark，具有平滑的动画效果，其间禁止其他用户交互\n */\n\nvar Camera = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.InteractorService), _dec(_class = (_class2 = (_temp = _class3 = /*#__PURE__*/function () {\n  function Camera() {\n    (0, _classCallCheck2.default)(this, Camera);\n    this.matrix = _glMatrix.mat4.create();\n    this.right = _glMatrix.vec3.fromValues(1, 0, 0);\n    this.up = _glMatrix.vec3.fromValues(0, 1, 0);\n    this.forward = _glMatrix.vec3.fromValues(0, 0, 1);\n    this.position = _glMatrix.vec3.fromValues(0, 0, 1);\n    this.focalPoint = _glMatrix.vec3.fromValues(0, 0, 0);\n    this.distanceVector = _glMatrix.vec3.fromValues(0, 0, 0);\n    this.distance = 1;\n    this.azimuth = 0;\n    this.elevation = 0;\n    this.roll = 0;\n    this.relAzimuth = 0;\n    this.relElevation = 0;\n    this.relRoll = 0;\n    this.dollyingStep = 0;\n    this.maxDistance = Infinity;\n    this.minDistance = -Infinity;\n    this.rotateWorld = false;\n    (0, _initializerDefineProperty2.default)(this, \"interactor\", _descriptor, this);\n    this.fov = 30;\n    this.near = 0.1;\n    this.far = 10000;\n    this.aspect = 1;\n    this.left = void 0;\n    this.rright = void 0;\n    this.top = void 0;\n    this.bottom = void 0;\n    this.zoom = 1;\n    this.perspective = _glMatrix.mat4.create();\n    this.view = void 0;\n    this.following = undefined;\n    this.type = CAMERA_TYPE.EXPLORING;\n    this.trackingMode = CAMERA_TRACKING_MODE.DEFAULT;\n    this.projectionMode = CAMERA_PROJECTION_MODE.PERSPECTIVE;\n    this.frustum = new _gWebgpuCore.Frustum();\n    this.landmarks = [];\n    this.landmarkAnimationID = void 0;\n  }\n\n  (0, _createClass2.default)(Camera, [{\n    key: \"clone\",\n    value: function clone() {\n      var camera = new Camera();\n      camera.setType(this.type, undefined);\n      camera.interactor = this.interactor;\n      return camera;\n    }\n  }, {\n    key: \"getProjectionMode\",\n    value: function getProjectionMode() {\n      return this.projectionMode;\n    }\n  }, {\n    key: \"getPerspective\",\n    value: function getPerspective() {\n      return this.perspective;\n    }\n  }, {\n    key: \"getFrustum\",\n    value: function getFrustum() {\n      return this.frustum;\n    }\n  }, {\n    key: \"getPosition\",\n    value: function getPosition() {\n      return this.position;\n    }\n  }, {\n    key: \"setType\",\n    value: function setType(type, trackingMode) {\n      this.type = type;\n\n      if (this.type === CAMERA_TYPE.EXPLORING) {\n        this.setWorldRotation(true);\n      } else {\n        this.setWorldRotation(false);\n      }\n\n      this._getAngles();\n\n      if (this.type === CAMERA_TYPE.TRACKING && trackingMode !== undefined) {\n        this.setTrackingMode(trackingMode);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"setProjectionMode\",\n    value: function setProjectionMode(projectionMode) {\n      this.projectionMode = projectionMode;\n      return this;\n    }\n  }, {\n    key: \"setTrackingMode\",\n    value: function setTrackingMode(trackingMode) {\n      if (this.type !== CAMERA_TYPE.TRACKING) {\n        throw new Error('Impossible to set a tracking mode if the camera is not of tracking type');\n      }\n\n      this.trackingMode = trackingMode;\n      return this;\n    }\n    /**\n     * If flag is true, it reverses the azimuth and elevation angles.\n     * Subsequent calls to rotate, setAzimuth, setElevation,\n     * changeAzimuth or changeElevation will cause the inverted effect.\n     * setRoll or changeRoll is not affected by this method.\n     *\n     * This inversion is useful when one wants to simulate that the world\n     * is moving, instead of the camera.\n     *\n     * By default the camera angles are not reversed.\n     * @param {Boolean} flag the boolean flag to reverse the angles.\n     */\n\n  }, {\n    key: \"setWorldRotation\",\n    value: function setWorldRotation(flag) {\n      this.rotateWorld = flag;\n\n      this._getAngles();\n    }\n    /**\n     * 计算 MV 矩阵，为相机矩阵的逆矩阵\n     */\n\n  }, {\n    key: \"getViewTransform\",\n    value: function getViewTransform() {\n      return _glMatrix.mat4.invert(_glMatrix.mat4.create(), this.matrix);\n    }\n  }, {\n    key: \"getWorldTransform\",\n    value: function getWorldTransform() {\n      return this.matrix;\n    }\n    /**\n     * 设置相机矩阵\n     */\n\n  }, {\n    key: \"setMatrix\",\n    value: function setMatrix(matrix) {\n      this.matrix = matrix;\n\n      this._update();\n\n      return this;\n    }\n  }, {\n    key: \"setAspect\",\n    value: function setAspect(aspect) {\n      this.setPerspective(this.near, this.far, this.fov, aspect);\n      return this;\n    }\n    /**\n     * Sets an offset in a larger frustum, used in PixelPicking\n     */\n\n  }, {\n    key: \"setViewOffset\",\n    value: function setViewOffset(fullWidth, fullHeight, x, y, width, height) {\n      this.aspect = fullWidth / fullHeight;\n\n      if (this.view === undefined) {\n        this.view = {\n          enabled: true,\n          fullWidth: 1,\n          fullHeight: 1,\n          offsetX: 0,\n          offsetY: 0,\n          width: 1,\n          height: 1\n        };\n      }\n\n      this.view.enabled = true;\n      this.view.fullWidth = fullWidth;\n      this.view.fullHeight = fullHeight;\n      this.view.offsetX = x;\n      this.view.offsetY = y;\n      this.view.width = width;\n      this.view.height = height;\n\n      if (this.projectionMode === CAMERA_PROJECTION_MODE.PERSPECTIVE) {\n        this.setPerspective(this.near, this.far, this.fov, this.aspect);\n      } else {\n        this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"clearViewOffset\",\n    value: function clearViewOffset() {\n      if (this.view !== undefined) {\n        this.view.enabled = false;\n      }\n\n      if (this.projectionMode === CAMERA_PROJECTION_MODE.PERSPECTIVE) {\n        this.setPerspective(this.near, this.far, this.fov, this.aspect);\n      } else {\n        this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"setPerspective\",\n    value: function setPerspective(near, far, fov, aspect) {\n      this.projectionMode = CAMERA_PROJECTION_MODE.PERSPECTIVE;\n      this.fov = fov;\n      this.near = near;\n      this.far = far;\n      this.aspect = aspect;\n\n      _glMatrix.mat4.perspective(this.perspective, this.fov * DEG_2_RAD, this.aspect, this.near, this.far);\n\n      return this;\n    }\n  }, {\n    key: \"setOrthographic\",\n    value: function setOrthographic(l, r, t, b, near, far) {\n      this.projectionMode = CAMERA_PROJECTION_MODE.ORTHOGRAPHIC;\n      this.rright = r;\n      this.left = l;\n      this.top = t;\n      this.bottom = b;\n      this.near = near;\n      this.far = far;\n      var dx = (this.rright - this.left) / (2 * this.zoom);\n      var dy = (this.top - this.bottom) / (2 * this.zoom);\n      var cx = (this.rright + this.left) / 2;\n      var cy = (this.top + this.bottom) / 2;\n      var left = cx - dx;\n      var right = cx + dx;\n      var top = cy + dy;\n      var bottom = cy - dy;\n\n      if (this.view !== undefined && this.view.enabled) {\n        var scaleW = (this.rright - this.left) / this.view.fullWidth / this.zoom;\n        var scaleH = (this.top - this.bottom) / this.view.fullHeight / this.zoom;\n        left += scaleW * this.view.offsetX;\n        right = left + scaleW * this.view.width;\n        top -= scaleH * this.view.offsetY;\n        bottom = top - scaleH * this.view.height;\n      }\n\n      _glMatrix.mat4.ortho(this.perspective, left, right, top, bottom, near, far);\n\n      return this;\n    }\n    /**\n     * 设置相机位置\n     */\n\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(x, y, z) {\n      this._setPosition(x, y, z);\n\n      this.setFocalPoint(this.focalPoint);\n      return this;\n    }\n    /**\n     * 设置视点位置\n     */\n\n  }, {\n    key: \"setFocalPoint\",\n    value: function setFocalPoint(x, y, z) {\n      var up = _glMatrix.vec3.fromValues(0, 1, 0);\n\n      this.focalPoint = (0, _math.createVec3)(x, y, z);\n\n      if (this.trackingMode === CAMERA_TRACKING_MODE.CINEMATIC) {\n        var d = _glMatrix.vec3.subtract(_glMatrix.vec3.create(), this.focalPoint, this.position);\n\n        x = d[0];\n        y = d[1];\n        z = d[2];\n\n        var r = _glMatrix.vec3.length(d);\n\n        var el = Math.asin(y / r) * RAD_2_DEG;\n        var az = 90 + Math.atan2(z, x) * RAD_2_DEG;\n\n        var m = _glMatrix.mat4.create();\n\n        _glMatrix.mat4.rotateY(m, m, az * DEG_2_RAD);\n\n        _glMatrix.mat4.rotateX(m, m, el * DEG_2_RAD);\n\n        up = _glMatrix.vec3.transformMat4(_glMatrix.vec3.create(), [0, 1, 0], m);\n      }\n\n      _glMatrix.mat4.invert(this.matrix, _glMatrix.mat4.lookAt(_glMatrix.mat4.create(), this.position, this.focalPoint, up));\n\n      this._getAxes();\n\n      this._getDistance();\n\n      this._getAngles();\n\n      return this;\n    }\n    /**\n     * 固定当前视点，按指定距离放置相机\n     */\n\n  }, {\n    key: \"setDistance\",\n    value: function setDistance(d) {\n      if (this.distance === d || d < 0) {\n        return;\n      }\n\n      this.distance = d;\n\n      if (this.distance < 0.0002) {\n        this.distance = 0.0002;\n      }\n\n      this.dollyingStep = this.distance / 100;\n\n      var pos = _glMatrix.vec3.create();\n\n      d = this.distance;\n      var n = this.forward;\n      var f = this.focalPoint;\n      pos[0] = d * n[0] + f[0];\n      pos[1] = d * n[1] + f[1];\n      pos[2] = d * n[2] + f[2];\n\n      this._setPosition(pos);\n\n      return this;\n    }\n  }, {\n    key: \"setMaxDistance\",\n    value: function setMaxDistance(d) {\n      this.maxDistance = d;\n      return this;\n    }\n  }, {\n    key: \"setMinDistance\",\n    value: function setMinDistance(d) {\n      this.minDistance = d;\n      return this;\n    }\n    /**\n     * Changes the initial azimuth of the camera\n     */\n\n  }, {\n    key: \"changeAzimuth\",\n    value: function changeAzimuth(az) {\n      this.setAzimuth(this.azimuth + az);\n      return this;\n    }\n    /**\n     * Changes the initial elevation of the camera\n     */\n\n  }, {\n    key: \"changeElevation\",\n    value: function changeElevation(el) {\n      this.setElevation(this.elevation + el);\n      return this;\n    }\n    /**\n     * Changes the initial roll of the camera\n     */\n\n  }, {\n    key: \"changeRoll\",\n    value: function changeRoll(rl) {\n      this.setRoll(this.roll + rl);\n      return this;\n    }\n    /**\n     * 设置相机方位角，不同相机模式下需要重新计算相机位置或者是视点位置\n     * @param {Number} el the azimuth in degrees\n     */\n\n  }, {\n    key: \"setAzimuth\",\n    value: function setAzimuth(az) {\n      this.azimuth = (0, _math.getAngle)(az);\n      this.computeMatrix();\n\n      this._getAxes();\n\n      if (this.type === CAMERA_TYPE.ORBITING || this.type === CAMERA_TYPE.EXPLORING) {\n        this._getPosition();\n      } else if (this.type === CAMERA_TYPE.TRACKING) {\n        this._getFocalPoint();\n      }\n\n      return this;\n    }\n  }, {\n    key: \"getAzimuth\",\n    value: function getAzimuth() {\n      return this.azimuth;\n    }\n    /**\n     * 设置相机方位角，不同相机模式下需要重新计算相机位置或者是视点位置\n     * @param {Number} el the elevation in degrees\n     */\n\n  }, {\n    key: \"setElevation\",\n    value: function setElevation(el) {\n      this.elevation = (0, _math.getAngle)(el);\n      this.computeMatrix();\n\n      this._getAxes();\n\n      if (this.type === CAMERA_TYPE.ORBITING || this.type === CAMERA_TYPE.EXPLORING) {\n        this._getPosition();\n      } else if (this.type === CAMERA_TYPE.TRACKING) {\n        this._getFocalPoint();\n      }\n\n      return this;\n    }\n    /**\n     * 设置相机方位角，不同相机模式下需要重新计算相机位置或者是视点位置\n     * @param {Number} angle the roll angle\n     */\n\n  }, {\n    key: \"setRoll\",\n    value: function setRoll(angle) {\n      this.roll = (0, _math.getAngle)(angle);\n      this.computeMatrix();\n\n      this._getAxes();\n\n      if (this.type === CAMERA_TYPE.ORBITING || this.type === CAMERA_TYPE.EXPLORING) {\n        this._getPosition();\n      } else if (this.type === CAMERA_TYPE.TRACKING) {\n        this._getFocalPoint();\n      }\n\n      return this;\n    }\n    /**\n     * Changes the azimuth and elevation with respect to the current camera axes\n     * @param {Number} azimuth the relative azimuth\n     * @param {Number} elevation the relative elevation\n     * @param {Number} roll the relative roll\n     */\n\n  }, {\n    key: \"rotate\",\n    value: function rotate(azimuth, elevation, roll) {\n      if (this.type === CAMERA_TYPE.EXPLORING) {\n        azimuth = (0, _math.getAngle)(azimuth);\n        elevation = (0, _math.getAngle)(elevation);\n        roll = (0, _math.getAngle)(roll);\n\n        var rotX = _glMatrix.quat.setAxisAngle(_glMatrix.quat.create(), [1, 0, 0], (this.rotateWorld ? 1 : -1) * elevation * DEG_2_RAD);\n\n        var rotY = _glMatrix.quat.setAxisAngle(_glMatrix.quat.create(), [0, 1, 0], (this.rotateWorld ? 1 : -1) * azimuth * DEG_2_RAD);\n\n        var rotZ = _glMatrix.quat.setAxisAngle(_glMatrix.quat.create(), [0, 0, 1], roll * DEG_2_RAD);\n\n        var rotQ = _glMatrix.quat.multiply(_glMatrix.quat.create(), rotY, rotX);\n\n        rotQ = _glMatrix.quat.multiply(_glMatrix.quat.create(), rotQ, rotZ);\n\n        var rotMatrix = _glMatrix.mat4.fromQuat(_glMatrix.mat4.create(), rotQ);\n\n        _glMatrix.mat4.translate(this.matrix, this.matrix, [0, 0, -this.distance]);\n\n        _glMatrix.mat4.multiply(this.matrix, this.matrix, rotMatrix);\n\n        _glMatrix.mat4.translate(this.matrix, this.matrix, [0, 0, this.distance]);\n      } else {\n        if (Math.abs(this.elevation + elevation) > 90) {\n          return;\n        }\n\n        this.relElevation = (0, _math.getAngle)(elevation);\n        this.relAzimuth = (0, _math.getAngle)(azimuth);\n        this.relRoll = (0, _math.getAngle)(roll);\n        this.elevation += this.relElevation;\n        this.azimuth += this.relAzimuth;\n        this.roll += this.relRoll;\n        this.computeMatrix();\n      }\n\n      this._getAxes();\n\n      if (this.type === CAMERA_TYPE.ORBITING || this.type === CAMERA_TYPE.EXPLORING) {\n        this._getPosition();\n      } else if (this.type === CAMERA_TYPE.TRACKING) {\n        this._getFocalPoint();\n      }\n\n      this._update();\n\n      return this;\n    }\n    /**\n     * 沿水平(right) & 垂直(up)平移相机\n     */\n\n  }, {\n    key: \"pan\",\n    value: function pan(tx, ty) {\n      var coords = (0, _math.createVec3)(tx, ty, 0);\n\n      var pos = _glMatrix.vec3.clone(this.position);\n\n      _glMatrix.vec3.add(pos, pos, _glMatrix.vec3.scale(_glMatrix.vec3.create(), this.right, coords[0]));\n\n      _glMatrix.vec3.add(pos, pos, _glMatrix.vec3.scale(_glMatrix.vec3.create(), this.up, coords[1]));\n\n      this._setPosition(pos);\n\n      return this;\n    }\n    /**\n     * 沿 n 轴移动，当距离视点远时移动速度较快，离视点越近速度越慢\n     */\n\n  }, {\n    key: \"dolly\",\n    value: function dolly(value) {\n      var n = this.forward;\n\n      var pos = _glMatrix.vec3.clone(this.position);\n\n      var step = value * this.dollyingStep;\n      var updatedDistance = this.distance + value * this.dollyingStep; // 限制视点距离范围\n\n      step = Math.max(Math.min(updatedDistance, this.maxDistance), this.minDistance) - this.distance;\n      pos[0] += step * n[0];\n      pos[1] += step * n[1];\n      pos[2] += step * n[2];\n\n      this._setPosition(pos);\n\n      if (this.type === CAMERA_TYPE.ORBITING || this.type === CAMERA_TYPE.EXPLORING) {\n        // 重新计算视点距离\n        this._getDistance();\n      } else if (this.type === CAMERA_TYPE.TRACKING) {\n        // 保持视距，移动视点位置\n        _glMatrix.vec3.add(this.focalPoint, pos, this.distanceVector);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"createLandmark\",\n    value: function createLandmark(name, params) {\n      var camera = this.clone();\n      camera.setPosition(params.position);\n      camera.setFocalPoint(params.focalPoint);\n\n      if (params.roll !== undefined) {\n        camera.setRoll(params.roll);\n      }\n\n      var landmark = new _Landmark.default(name, camera);\n      this.landmarks.push(landmark);\n      return landmark;\n    }\n  }, {\n    key: \"setLandmark\",\n    value: function setLandmark(name) {\n      var landmark = new _Landmark.default(name, this);\n      this.landmarks.push(landmark);\n      return this;\n    }\n  }, {\n    key: \"gotoLandmark\",\n    value: function gotoLandmark(name) {\n      var _this = this;\n\n      var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n      var landmark = this.landmarks.find(function (l) {\n        return l.name === name;\n      });\n\n      if (landmark) {\n        if (duration === 0) {\n          landmark.retrieve(this);\n          return;\n        }\n\n        if (this.landmarkAnimationID !== undefined) {\n          window.cancelAnimationFrame(this.landmarkAnimationID);\n        } // TODO: do not process events during animation\n\n\n        this.interactor.disconnect();\n        var destPosition = landmark.getPosition();\n        var destFocalPoint = landmark.getFocalPoint();\n        var destRoll = landmark.getRoll();\n        var timeStart;\n\n        var animate = function animate(timestamp) {\n          if (timeStart === undefined) {\n            timeStart = timestamp;\n          }\n\n          var elapsed = timestamp - timeStart; // TODO: use better ease function\n\n          var t = (1 - Math.cos(elapsed / duration * Math.PI)) / 2;\n\n          var interFocalPoint = _glMatrix.vec3.create();\n\n          var interPosition = _glMatrix.vec3.create();\n\n          var interRoll = 0;\n\n          _glMatrix.vec3.lerp(interFocalPoint, _this.focalPoint, destFocalPoint, t);\n\n          _glMatrix.vec3.lerp(interPosition, _this.position, destPosition, t);\n\n          interRoll = _this.roll * (1 - t) + destRoll * t;\n\n          _this.setFocalPoint(interFocalPoint);\n\n          _this.setPosition(interPosition);\n\n          _this.setRoll(interRoll);\n\n          _this.computeMatrix();\n\n          var dist = _glMatrix.vec3.dist(interFocalPoint, destFocalPoint) + _glMatrix.vec3.dist(interPosition, destPosition);\n\n          if (dist > 0.01) {//\n          } else {\n            _this.setFocalPoint(interFocalPoint);\n\n            _this.setPosition(interPosition);\n\n            _this.setRoll(interRoll);\n\n            _this.computeMatrix();\n\n            _this.interactor.connect();\n\n            return;\n          }\n\n          if (elapsed < duration) {\n            _this.landmarkAnimationID = window.requestAnimationFrame(animate);\n          }\n        };\n\n        window.requestAnimationFrame(animate);\n      }\n    }\n    /**\n     * 根据相机矩阵重新计算各种相机参数\n     */\n\n  }, {\n    key: \"_update\",\n    value: function _update() {\n      this._getAxes();\n\n      this._getPosition();\n\n      this._getDistance();\n\n      this._getAngles();\n    }\n    /**\n     * 计算相机矩阵\n     */\n\n  }, {\n    key: \"computeMatrix\",\n    value: function computeMatrix() {\n      var rotX;\n      var rotY; // 使用四元数描述 3D 旋转\n      // @see https://xiaoiver.github.io/coding/2018/12/28/Camera-%E8%AE%BE%E8%AE%A1-%E4%B8%80.html\n\n      var rotZ = _glMatrix.quat.setAxisAngle(_glMatrix.quat.create(), [0, 0, 1], this.roll * DEG_2_RAD);\n\n      _glMatrix.mat4.identity(this.matrix); // only consider HCS for EXPLORING and ORBITING cameras\n\n\n      rotX = _glMatrix.quat.setAxisAngle(_glMatrix.quat.create(), [1, 0, 0], (this.rotateWorld && this.type !== CAMERA_TYPE.TRACKING || this.type === CAMERA_TYPE.TRACKING ? 1 : -1) * this.elevation * DEG_2_RAD);\n      rotY = _glMatrix.quat.setAxisAngle(_glMatrix.quat.create(), [0, 1, 0], (this.rotateWorld && this.type !== CAMERA_TYPE.TRACKING || this.type === CAMERA_TYPE.TRACKING ? 1 : -1) * this.azimuth * DEG_2_RAD);\n\n      var rotQ = _glMatrix.quat.multiply(_glMatrix.quat.create(), rotY, rotX);\n\n      rotQ = _glMatrix.quat.multiply(_glMatrix.quat.create(), rotQ, rotZ);\n\n      var rotMatrix = _glMatrix.mat4.fromQuat(_glMatrix.mat4.create(), rotQ);\n\n      if (this.type === CAMERA_TYPE.ORBITING || this.type === CAMERA_TYPE.EXPLORING) {\n        _glMatrix.mat4.translate(this.matrix, this.matrix, this.focalPoint);\n\n        _glMatrix.mat4.multiply(this.matrix, this.matrix, rotMatrix);\n\n        _glMatrix.mat4.translate(this.matrix, this.matrix, [0, 0, this.distance]);\n      } else if (this.type === CAMERA_TYPE.TRACKING) {\n        _glMatrix.mat4.translate(this.matrix, this.matrix, this.position);\n\n        _glMatrix.mat4.multiply(this.matrix, this.matrix, rotMatrix);\n      }\n    }\n    /**\n     * Sets the camera position in the camera matrix\n     */\n\n  }, {\n    key: \"_setPosition\",\n    value: function _setPosition(x, y, z) {\n      this.position = (0, _math.createVec3)(x, y, z);\n      var m = this.matrix;\n      m[12] = this.position[0];\n      m[13] = this.position[1];\n      m[14] = this.position[2];\n      m[15] = 1;\n    }\n    /**\n     * Recalculates axes based on the current matrix\n     */\n\n  }, {\n    key: \"_getAxes\",\n    value: function _getAxes() {\n      _glMatrix.vec3.copy(this.right, (0, _math.createVec3)(_glMatrix.vec4.transformMat4(_glMatrix.vec4.create(), [1, 0, 0, 0], this.matrix)));\n\n      _glMatrix.vec3.copy(this.up, (0, _math.createVec3)(_glMatrix.vec4.transformMat4(_glMatrix.vec4.create(), [0, 1, 0, 0], this.matrix)));\n\n      _glMatrix.vec3.copy(this.forward, (0, _math.createVec3)(_glMatrix.vec4.transformMat4(_glMatrix.vec4.create(), [0, 0, 1, 0], this.matrix)));\n\n      _glMatrix.vec3.normalize(this.right, this.right);\n\n      _glMatrix.vec3.normalize(this.up, this.up);\n\n      _glMatrix.vec3.normalize(this.forward, this.forward);\n    }\n    /**\n     * Recalculates euler angles based on the current state\n     */\n\n  }, {\n    key: \"_getAngles\",\n    value: function _getAngles() {\n      // Recalculates angles\n      var x = this.distanceVector[0];\n      var y = this.distanceVector[1];\n      var z = this.distanceVector[2];\n\n      var r = _glMatrix.vec3.length(this.distanceVector); // FAST FAIL: If there is no distance we cannot compute angles\n\n\n      if (r === 0) {\n        this.elevation = 0;\n        this.azimuth = 0;\n        return;\n      }\n\n      if (this.type === CAMERA_TYPE.TRACKING) {\n        this.elevation = Math.asin(y / r) * RAD_2_DEG;\n        this.azimuth = Math.atan2(-x, -z) * RAD_2_DEG;\n      } else {\n        if (this.rotateWorld) {\n          this.elevation = Math.asin(y / r) * RAD_2_DEG;\n          this.azimuth = Math.atan2(-x, -z) * RAD_2_DEG;\n        } else {\n          this.elevation = -Math.asin(y / r) * RAD_2_DEG;\n          this.azimuth = -Math.atan2(-x, -z) * RAD_2_DEG;\n        }\n      }\n    }\n    /**\n     * 重新计算相机位置，只有 ORBITING 模式相机位置才会发生变化\n     */\n\n  }, {\n    key: \"_getPosition\",\n    value: function _getPosition() {\n      _glMatrix.vec3.copy(this.position, (0, _math.createVec3)(_glMatrix.vec4.transformMat4(_glMatrix.vec4.create(), [0, 0, 0, 1], this.matrix))); // 相机位置变化，需要重新计算视距\n\n\n      this._getDistance();\n    }\n    /**\n     * 重新计算视点，只有 TRACKING 模式视点才会发生变化\n     */\n\n  }, {\n    key: \"_getFocalPoint\",\n    value: function _getFocalPoint() {\n      _glMatrix.vec3.transformMat3(this.distanceVector, [0, 0, -this.distance], _glMatrix.mat3.fromMat4(_glMatrix.mat3.create(), this.matrix));\n\n      _glMatrix.vec3.add(this.focalPoint, this.position, this.distanceVector); // 视点变化，需要重新计算视距\n\n\n      this._getDistance();\n    }\n    /**\n     * 重新计算视距\n     */\n\n  }, {\n    key: \"_getDistance\",\n    value: function _getDistance() {\n      this.distanceVector = _glMatrix.vec3.subtract(_glMatrix.vec3.create(), this.focalPoint, this.position);\n      this.distance = _glMatrix.vec3.length(this.distanceVector);\n      this.dollyingStep = this.distance / 100;\n    }\n  }]);\n  return Camera;\n}(), _class3.ProjectionMode = {\n  ORTHOGRAPHIC: 'ORTHOGRAPHIC',\n  PERSPECTIVE: 'PERSPECTIVE'\n}, _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"interactor\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Camera = Camera;\n//# sourceMappingURL=Camera.js.map","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getAngle = getAngle;\nexports.createVec3 = createVec3;\n\nvar _glMatrix = require(\"gl-matrix\");\n\nvar _isNumber = require(\"./is-number\");\n\nfunction getAngle(angle) {\n  if (angle === undefined) {\n    return 0;\n  } else if (angle > 360 || angle < -360) {\n    return angle % 360;\n  }\n\n  return angle;\n}\n\nfunction createVec3(x, y, z) {\n  if ((0, _isNumber.isNumber)(x)) {\n    return _glMatrix.vec3.fromValues(x, y, z);\n  }\n\n  if (x.length === 3) {\n    return _glMatrix.vec3.clone(x);\n  } // @ts-ignore\n\n\n  return _glMatrix.vec3.fromValues(x[0], x[1], x[2]);\n}\n//# sourceMappingURL=math.js.map","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isNumber = isNumber;\n\nfunction isNumber(value) {\n  return typeof value === 'number';\n}\n//# sourceMappingURL=is-number.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _glMatrix = require(\"gl-matrix\");\n\n/**\n * 保存相机状态，便于后续在多个 Landmark 间移动\n */\nvar Landmark = /*#__PURE__*/function () {\n  function Landmark(name, c) {\n    (0, _classCallCheck2.default)(this, Landmark);\n    this.name = void 0;\n    this.matrix = void 0;\n    this.right = void 0;\n    this.up = void 0;\n    this.forward = void 0;\n    this.position = void 0;\n    this.focalPoint = void 0;\n    this.distanceVector = void 0;\n    this.distance = void 0;\n    this.dollyingStep = void 0;\n    this.azimuth = 0;\n    this.elevation = 0;\n    this.roll = 0;\n    this.relAzimuth = 0;\n    this.relElevation = 0;\n    this.relRoll = 0;\n    this.name = name;\n    this.matrix = _glMatrix.mat4.clone(c.matrix);\n    this.right = _glMatrix.vec3.clone(c.right);\n    this.up = _glMatrix.vec3.clone(c.up);\n    this.forward = _glMatrix.vec3.clone(c.forward);\n    this.position = _glMatrix.vec3.clone(c.position);\n    this.focalPoint = _glMatrix.vec3.clone(c.focalPoint);\n    this.distanceVector = _glMatrix.vec3.clone(c.distanceVector);\n    this.azimuth = c.azimuth;\n    this.elevation = c.elevation;\n    this.roll = c.roll;\n    this.relAzimuth = c.relAzimuth;\n    this.relElevation = c.relElevation;\n    this.relRoll = c.relRoll;\n    this.dollyingStep = c.dollyingStep;\n    this.distance = c.distance;\n  }\n\n  (0, _createClass2.default)(Landmark, [{\n    key: \"getPosition\",\n    value: function getPosition() {\n      return this.position;\n    }\n  }, {\n    key: \"getFocalPoint\",\n    value: function getFocalPoint() {\n      return this.focalPoint;\n    }\n  }, {\n    key: \"getRoll\",\n    value: function getRoll() {\n      return this.roll;\n    }\n  }, {\n    key: \"retrieve\",\n    value: function retrieve(c) {\n      c.matrix = _glMatrix.mat4.copy(c.matrix, this.matrix);\n      c.right = _glMatrix.vec3.copy(c.right, this.right);\n      c.up = _glMatrix.vec3.copy(c.up, this.up);\n      c.forward = _glMatrix.vec3.copy(c.forward, this.forward);\n      c.position = _glMatrix.vec3.copy(c.position, this.position);\n      c.focalPoint = _glMatrix.vec3.copy(c.focalPoint, this.focalPoint);\n      c.distanceVector = _glMatrix.vec3.copy(c.distanceVector, this.distanceVector);\n      c.azimuth = this.azimuth;\n      c.elevation = this.elevation;\n      c.roll = this.roll;\n      c.relAzimuth = this.relAzimuth;\n      c.relElevation = this.relElevation;\n      c.relRoll = this.relRoll;\n      c.dollyingStep = this.dollyingStep;\n      c.distance = this.distance;\n    }\n  }]);\n  return Landmark;\n}();\n\nexports.default = Landmark;\n//# sourceMappingURL=Landmark.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Geometry = void 0;\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _dec, _dec2, _class, _class2, _descriptor, _class3, _temp;\n\nvar Geometry = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.GeometryComponentManager), _dec(_class = (_class2 = (_temp = _class3 = /*#__PURE__*/function () {\n  function Geometry() {\n    (0, _classCallCheck2.default)(this, Geometry);\n    this.config = void 0;\n    (0, _initializerDefineProperty2.default)(this, \"geometry\", _descriptor, this);\n    this.entity = void 0;\n    this.component = void 0;\n  }\n\n  (0, _createClass2.default)(Geometry, [{\n    key: \"getEntity\",\n    value: function getEntity() {\n      return this.entity;\n    }\n  }, {\n    key: \"getComponent\",\n    value: function getComponent() {\n      return this.component;\n    }\n  }, {\n    key: \"setConfig\",\n    value: function setConfig(config) {\n      this.config = config;\n    }\n  }, {\n    key: \"setEntity\",\n    value: function setEntity(entity) {\n      this.entity = entity;\n      this.component = this.geometry.create(entity);\n      this.component.entity = entity;\n      this.onEntityCreated();\n    }\n  }, {\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {//\n    }\n  }]);\n  return Geometry;\n}(), _class3.BOX = 'box', _class3.SPHERE = 'sphere', _class3.PLANE = 'plane', _class3.MERGED = 'merged', _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"geometry\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Geometry = Geometry;\n//# sourceMappingURL=index.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Kernel = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar WebGPUConstants = _interopRequireWildcard(require(\"@webgpu/types/dist/constants\"));\n\nvar _inversify = require(\"inversify\");\n\nvar _canvas = require(\"./utils/canvas\");\n\nvar _isArray = _interopRequireDefault(require(\"./utils/is-array\"));\n\nvar _isNumber = require(\"./utils/is-number\");\n\nvar _isTypedarray = require(\"./utils/is-typedarray\");\n\nvar _dec, _dec2, _dec3, _class, _class2, _descriptor, _descriptor2, _temp;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar Kernel = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.RenderEngine), _dec3 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.ConfigService), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function () {\n  function Kernel() {\n    (0, _classCallCheck2.default)(this, Kernel);\n    (0, _initializerDefineProperty2.default)(this, \"engine\", _descriptor, this);\n    (0, _initializerDefineProperty2.default)(this, \"configService\", _descriptor2, this);\n    this.entity = (0, _gWebgpuCore.createEntity)();\n    this.model = void 0;\n    this.dirty = true;\n    this.compiledBundle = void 0;\n    this.initPromise = void 0;\n  }\n\n  (0, _createClass2.default)(Kernel, [{\n    key: \"init\",\n    value: function init() {\n      var _this$configService$g = this.configService.get(),\n          canvas = _this$configService$g.canvas,\n          engineOptions = _this$configService$g.engineOptions;\n\n      this.initPromise = this.engine.init(_objectSpread({\n        canvas: canvas || (0, _canvas.createCanvas)(),\n        swapChainFormat: WebGPUConstants.TextureFormat.BGRA8Unorm,\n        antialiasing: false\n      }, engineOptions));\n    }\n  }, {\n    key: \"setBundle\",\n    value: function setBundle(bundle) {\n      // deep clone\n      this.compiledBundle = JSON.parse(JSON.stringify(bundle));\n    }\n  }, {\n    key: \"setDispatch\",\n    value: function setDispatch(dispatch) {\n      if (this.compiledBundle.context) {\n        this.compiledBundle.context.dispatch = dispatch;\n      }\n\n      return this;\n    }\n  }, {\n    key: \"setMaxIteration\",\n    value: function setMaxIteration(maxIteration) {\n      if (this.compiledBundle.context) {\n        this.compiledBundle.context.maxIteration = maxIteration;\n      }\n\n      return this;\n    }\n  }, {\n    key: \"setBinding\",\n    value: function setBinding(name, data) {\n      var _this = this;\n\n      if (typeof name === 'string') {\n        var isNumberLikeData = (0, _isNumber.isNumber)(data) || (0, _isTypedarray.isTypedArray)(data) || (0, _isArray.default)(data);\n\n        if (this.compiledBundle && this.compiledBundle.context) {\n          // set define, eg. setBinding('MAX_LENGTH', 10)\n          var existedDefine = this.compiledBundle.context.defines.find(function (b) {\n            return b.name === name;\n          });\n\n          if (existedDefine) {\n            existedDefine.value = data;\n            return this;\n          } // set uniform\n\n\n          var existedBinding = this.compiledBundle.context.uniforms.find(function (b) {\n            return b.name === name;\n          });\n\n          if (existedBinding) {\n            // update uniform or buffer\n            if (isNumberLikeData) {\n              // @ts-ignore\n              existedBinding.data = data;\n              existedBinding.isReferer = false;\n\n              if (existedBinding.storageClass === _gWebgpuCore.STORAGE_CLASS.Uniform) {\n                if (this.model) {\n                  // @ts-ignore\n                  this.model.updateUniform(name, data);\n                }\n              } else {\n                if (this.model) {\n                  // @ts-ignore\n                  this.model.updateBuffer(name, data);\n                }\n              }\n            } else {\n              // update with another kernel\n              existedBinding.isReferer = true; // @ts-ignore\n\n              existedBinding.data = data;\n            }\n          }\n        }\n      } else {\n        Object.keys(name).forEach(function (key) {\n          _this.setBinding(key, name[key]);\n        });\n      }\n\n      return this;\n    }\n  }, {\n    key: \"execute\",\n    value: function () {\n      var _execute = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n        var _this2 = this;\n\n        var iteration,\n            i,\n            _args = arguments;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                iteration = _args.length > 0 && _args[0] !== undefined ? _args[0] : 1;\n\n                if (!this.dirty) {\n                  _context.next = 6;\n                  break;\n                }\n\n                if (this.compiledBundle.context) {\n                  if (iteration > 1) {\n                    this.compiledBundle.context.maxIteration = iteration;\n                  } else {\n                    this.compiledBundle.context.maxIteration++;\n                  }\n                }\n\n                _context.next = 5;\n                return this.compile();\n\n              case 5:\n                this.dirty = false;\n\n              case 6:\n                this.engine.beginFrame(); // 首先开启当前 frame 的 compute pass\n\n                this.engine.clear({});\n\n                if (this.compiledBundle.context) {\n                  this.compiledBundle.context.uniforms.filter(function (_ref) {\n                    var isReferer = _ref.isReferer;\n                    return isReferer;\n                  }).forEach(function (_ref2) {\n                    var data = _ref2.data,\n                        name = _ref2.name;\n\n                    // @ts-ignore\n                    _this2.model.confirmInput(data.model, name);\n                  });\n                }\n\n                for (i = 0; i < iteration; i++) {\n                  this.model.run();\n                }\n\n                this.engine.endFrame();\n                return _context.abrupt(\"return\", this);\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function execute() {\n        return _execute.apply(this, arguments);\n      }\n\n      return execute;\n    }()\n    /**\n     * read output from GPUBuffer\n     */\n\n  }, {\n    key: \"getOutput\",\n    value: function () {\n      var _getOutput = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", this.model.readData());\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getOutput() {\n        return _getOutput.apply(this, arguments);\n      }\n\n      return getOutput;\n    }()\n  }, {\n    key: \"compile\",\n    value: function () {\n      var _compile = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3() {\n        var context, target, shader;\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.initPromise;\n\n              case 2:\n                context = _objectSpread({}, this.compiledBundle.context);\n                target = this.engine.supportWebGPU ? this.engine.useWGSL ? _gWebgpuCore.Target.WGSL : _gWebgpuCore.Target.GLSL450 : _gWebgpuCore.Target.GLSL100;\n                shader = this.compiledBundle.shaders[target]; // this.bindings?.forEach(({ name, data }) => {\n                //   if (name === name.toUpperCase()) {\n                //     const define = context.defines.find((d) => d.name === name);\n                //     if (define) {\n                //       // @ts-ignore\n                //       define.value = data;\n                //     }\n                //   }\n                // });\n                // 生成运行时 define\n\n                context.defines.filter(function (define) {\n                  return define.runtime;\n                }).forEach(function (define) {\n                  var valuePlaceHolder = \"\".concat(_gWebgpuCore.DefineValuePlaceholder).concat(define.name);\n                  shader = shader.replace(valuePlaceHolder, \"\".concat(define.value));\n                });\n                context.shader = shader; // 添加 uniform 绑定的数据\n\n                context.uniforms.forEach(function (uniform) {\n                  // const binding = this.bindings.find((b) => b.name === uniform.name);\n                  // if (binding) {\n                  //   // @ts-ignore\n                  //   uniform.data = binding.referer || binding.data;\n                  //   // @ts-ignore\n                  //   uniform.isReferer = !!binding.referer;\n                  // }\n                  // 未指定数据，尝试根据 uniform 类型初始化\n                  if (!uniform.data) {\n                    if (uniform.storageClass === _gWebgpuCore.STORAGE_CLASS.StorageBuffer) {\n                      var sizePerElement = 1;\n\n                      if (uniform.type === _gWebgpuCore.AST_TOKEN_TYPES.FloatArray) {\n                        sizePerElement = 1;\n                      } else if (uniform.type === _gWebgpuCore.AST_TOKEN_TYPES.Vector4FloatArray) {\n                        sizePerElement = 4;\n                      }\n\n                      uniform.data = new Float32Array(context.output.length * sizePerElement).fill(0);\n                    }\n                  }\n                }); // } else if (uniform.type === 'image2D') {\n                //   // @ts-ignore\n                //   buffer.data = new Uint8ClampedArray(context.output.length!).fill(0);\n                // }\n\n                this.compiledBundle.context = context;\n                _context3.next = 11;\n                return this.engine.createComputeModel(this.compiledBundle.context);\n\n              case 11:\n                this.model = _context3.sent;\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function compile() {\n        return _compile.apply(this, arguments);\n      }\n\n      return compile;\n    }()\n  }]);\n  return Kernel;\n}(), _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"engine\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"configService\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Kernel = Kernel;\n//# sourceMappingURL=Kernel.js.map","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createCanvas = createCanvas;\n\nfunction createCanvas() {\n  if (typeof document !== 'undefined') {\n    return document.createElement('canvas');\n  } else {\n    throw new Error('Cannot create a canvas in this context');\n  }\n}\n//# sourceMappingURL=canvas.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _isType = _interopRequireDefault(require(\"./is-type\"));\n\nvar _default = function _default(value) {\n  return Array.isArray ? Array.isArray(value) : (0, _isType.default)(value, 'Array');\n};\n\nexports.default = _default;\n//# sourceMappingURL=is-array.js.map","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar toString = {}.toString;\n\nvar isType = function isType(value, type) {\n  return toString.call(value) === '[object ' + type + ']';\n};\n\nvar _default = isType;\nexports.default = _default;\n//# sourceMappingURL=is-type.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isTypedArray = void 0;\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\n/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n/** `Object#toString` result references. */\n\nvar argsTag = '[object Arguments]';\nvar arrayTag = '[object Array]';\nvar boolTag = '[object Boolean]';\nvar dateTag = '[object Date]';\nvar errorTag = '[object Error]';\nvar funcTag = '[object Function]';\nvar mapTag = '[object Map]';\nvar numberTag = '[object Number]';\nvar objectTag = '[object Object]';\nvar regexpTag = '[object RegExp]';\nvar setTag = '[object Set]';\nvar stringTag = '[object String]';\nvar weakMapTag = '[object WeakMap]';\nvar arrayBufferTag = '[object ArrayBuffer]';\nvar dataViewTag = '[object DataView]';\nvar float32Tag = '[object Float32Array]';\nvar float64Tag = '[object Float64Array]';\nvar int8Tag = '[object Int8Array]';\nvar int16Tag = '[object Int16Array]';\nvar int32Tag = '[object Int32Array]';\nvar uint8Tag = '[object Uint8Array]';\nvar uint8ClampedTag = '[object Uint8ClampedArray]';\nvar uint16Tag = '[object Uint16Array]';\nvar uint32Tag = '[object Uint32Array]';\n/** Used to identify `toStringTag` values of typed arrays. */\n\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] = typedArrayTags[int8Tag] = typedArrayTags[int16Tag] = typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] = typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] = typedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] = typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] = typedArrayTags[dataViewTag] = typedArrayTags[dateTag] = typedArrayTags[errorTag] = typedArrayTags[funcTag] = typedArrayTags[mapTag] = typedArrayTags[numberTag] = typedArrayTags[objectTag] = typedArrayTags[regexpTag] = typedArrayTags[setTag] = typedArrayTags[stringTag] = typedArrayTags[weakMapTag] = false;\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\n\nfunction baseUnary(func) {\n  return function (value) {\n    return func(value);\n  };\n}\n/** Used for built-in method references. */\n\n\nvar objectProto = Object.prototype;\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\n\nvar objectToString = objectProto.toString;\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\n\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) && isLength(value.length) && !!typedArrayTags[objectToString.call(value)];\n}\n\nfunction isLength(value) {\n  return typeof value === 'number' && value > -1 && value % 1 === 0 && value <= MAX_SAFE_INTEGER;\n}\n\nfunction isObjectLike(value) {\n  return !!value && (0, _typeof2.default)(value) === 'object';\n}\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\n\n\nvar isTypedArray = baseIsTypedArray;\nexports.isTypedArray = isTypedArray;\n//# sourceMappingURL=is-typedarray.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Material = void 0;\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _dec, _dec2, _class, _class2, _descriptor, _class3, _temp;\n\nvar Material = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.MaterialComponentManager), _dec(_class = (_class2 = (_temp = _class3 = /*#__PURE__*/function () {\n  function Material() {\n    (0, _classCallCheck2.default)(this, Material);\n    this.config = void 0;\n    (0, _initializerDefineProperty2.default)(this, \"material\", _descriptor, this);\n    this.entity = void 0;\n    this.component = void 0;\n  }\n\n  (0, _createClass2.default)(Material, [{\n    key: \"getEntity\",\n    value: function getEntity() {\n      return this.entity;\n    }\n  }, {\n    key: \"getComponent\",\n    value: function getComponent() {\n      return this.component;\n    }\n  }, {\n    key: \"setConfig\",\n    value: function setConfig(config) {\n      this.config = config;\n    }\n  }, {\n    key: \"setEntity\",\n    value: function setEntity(entity, type) {\n      this.entity = entity;\n      this.component = this.material.create(entity);\n      this.component.entity = entity;\n      this.component.type = type;\n      this.onEntityCreated();\n    }\n  }, {\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {//\n    }\n  }]);\n  return Material;\n}(), _class3.BASIC = 'basic', _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"material\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Material = Material;\n//# sourceMappingURL=index.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Renderable = void 0;\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _class3, _temp;\n\nvar Renderable = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.MeshComponentManager), _dec3 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.CullableComponentManager), _dec4 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.TransformComponentManager), _dec5 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.Systems), _dec6 = (0, _inversify.named)(_gWebgpuCore.IDENTIFIER.SceneGraphSystem), _dec(_class = (_class2 = (_temp = _class3 = /*#__PURE__*/function () {\n  function Renderable() {\n    (0, _classCallCheck2.default)(this, Renderable);\n    this.attributes = {};\n    this.config = void 0;\n    (0, _initializerDefineProperty2.default)(this, \"mesh\", _descriptor, this);\n    (0, _initializerDefineProperty2.default)(this, \"cullable\", _descriptor2, this);\n    (0, _initializerDefineProperty2.default)(this, \"transform\", _descriptor3, this);\n    (0, _initializerDefineProperty2.default)(this, \"sceneGraphSystem\", _descriptor4, this);\n    this.meshComponent = void 0;\n    this.transformComponent = void 0;\n    this.entity = void 0;\n  }\n\n  (0, _createClass2.default)(Renderable, [{\n    key: \"getEntity\",\n    value: function getEntity() {\n      return this.entity;\n    }\n  }, {\n    key: \"getTransformComponent\",\n    value: function getTransformComponent() {\n      return this.transformComponent;\n    }\n  }, {\n    key: \"getMeshComponent\",\n    value: function getMeshComponent() {\n      return this.meshComponent;\n    }\n  }, {\n    key: \"setConfig\",\n    value: function setConfig(config) {\n      this.config = config;\n    }\n  }, {\n    key: \"setEntity\",\n    value: function setEntity(entity) {\n      this.entity = entity;\n      this.cullable.create(entity);\n      this.meshComponent = this.mesh.create(entity);\n      this.transformComponent = this.transform.create(entity);\n      this.onEntityCreated();\n    }\n  }, {\n    key: \"setMaterial\",\n    value: function setMaterial(material) {\n      this.meshComponent.material = material;\n      return this;\n    }\n  }, {\n    key: \"setGeometry\",\n    value: function setGeometry(geometry) {\n      this.meshComponent.geometry = geometry;\n      return this;\n    }\n  }, {\n    key: \"setAttributes\",\n    value: function setAttributes(attributes) {\n      var _this = this;\n\n      Object.keys(attributes).forEach(function (name) {\n        if (attributes[name] !== undefined && attributes[name] !== _this.attributes[name]) {\n          _this.onAttributeChanged({\n            name: name,\n            data: attributes[name]\n          });\n\n          _this.attributes[name] = attributes[name];\n        }\n      });\n    }\n  }, {\n    key: \"setVisible\",\n    value: function setVisible(visible) {\n      var _this2 = this;\n\n      this.meshComponent.visible = visible;\n      this.meshComponent.children.forEach(function (childEntity) {\n        var child = _this2.mesh.getComponentByEntity(childEntity);\n\n        if (child) {\n          child.visible = visible;\n        }\n      });\n      return this;\n    }\n  }, {\n    key: \"isVisible\",\n    value: function isVisible() {\n      return this.meshComponent.visible;\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(parentRenderable) {\n      this.sceneGraphSystem.attach(this.entity, parentRenderable.entity);\n      return this;\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      this.sceneGraphSystem.detach(this.entity);\n      return this;\n    }\n  }, {\n    key: \"detachChildren\",\n    value: function detachChildren() {\n      this.sceneGraphSystem.detachChildren(this.entity);\n      return this;\n    }\n  }, {\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {//\n    }\n  }, {\n    key: \"onAttributeChanged\",\n    value: function onAttributeChanged(_ref) {\n      var name = _ref.name,\n          data = _ref.data;\n\n      if (this.meshComponent && this.meshComponent.material) {\n        this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(name), data);\n      }\n    }\n  }, {\n    key: \"convertAttributeName2UniformName\",\n    value: function convertAttributeName2UniformName(attributeName) {\n      return attributeName;\n    }\n  }]);\n  return Renderable;\n}(), _class3.POINT = 'point', _class3.LINE = 'line', _class3.GRID = 'grid', _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"mesh\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"cullable\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"transform\", [_dec4], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor4 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"sceneGraphSystem\", [_dec5, _dec6], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Renderable = Renderable;\n//# sourceMappingURL=Renderable.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.World = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _gWebgpuEngine = require(\"@antv/g-webgpu-engine\");\n\nvar WebGPUConstants = _interopRequireWildcard(require(\"@webgpu/types/dist/constants\"));\n\nvar _inversify = require(\"inversify\");\n\nvar _Camera = require(\"./camera/Camera\");\n\nvar _geometry = require(\"./geometry\");\n\nvar _Box = require(\"./geometry/Box\");\n\nvar _Merged = require(\"./geometry/Merged\");\n\nvar _Plane = require(\"./geometry/Plane\");\n\nvar _Sphere = require(\"./geometry/Sphere\");\n\nvar _Kernel = require(\"./Kernel\");\n\nvar _material = require(\"./material\");\n\nvar _basic = require(\"./material/basic\");\n\nvar _grid = require(\"./renderable/grid\");\n\nvar _line = require(\"./renderable/line\");\n\nvar _point = require(\"./renderable/point\");\n\nvar _Renderable = require(\"./renderable/Renderable\");\n\nvar _Renderer = require(\"./Renderer\");\n\nvar _Scene = require(\"./Scene\");\n\nvar _Cache = require(\"./texture/Cache\");\n\nvar _Texture2D = require(\"./texture/Texture2D\");\n\nvar _canvas = require(\"./utils/canvas\");\n\nvar _View = require(\"./View\");\n\nvar _dec, _dec2, _class, _class2, _descriptor, _temp;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar World = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.ConfigService), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function () {\n  function World() {\n    (0, _classCallCheck2.default)(this, World);\n    (0, _initializerDefineProperty2.default)(this, \"configService\", _descriptor, this);\n    this.container = void 0;\n  }\n\n  (0, _createClass2.default)(World, [{\n    key: \"getEngine\",\n    value: function () {\n      var _getEngine = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n        var engine, _this$configService$g, canvas, engineOptions;\n\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                engine = this.container.get(_gWebgpuCore.IDENTIFIER.RenderEngine);\n                _this$configService$g = this.configService.get(), canvas = _this$configService$g.canvas, engineOptions = _this$configService$g.engineOptions;\n                _context.next = 4;\n                return engine.init(_objectSpread({\n                  canvas: canvas || (0, _canvas.createCanvas)(),\n                  swapChainFormat: WebGPUConstants.TextureFormat.BGRA8Unorm,\n                  antialiasing: false\n                }, engineOptions));\n\n              case 4:\n                return _context.abrupt(\"return\", engine);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getEngine() {\n        return _getEngine.apply(this, arguments);\n      }\n\n      return getEngine;\n    }()\n    /**\n     * get transform component\n     * @param entity\n     */\n\n  }, {\n    key: \"getTransformComponent\",\n    value: function getTransformComponent(entity) {\n      var manager = this.container.get(_gWebgpuCore.IDENTIFIER.TransformComponentManager);\n      return manager.getComponentByEntity(entity);\n    }\n  }, {\n    key: \"getMeshComponent\",\n    value: function getMeshComponent(entity) {\n      var manager = this.container.get(_gWebgpuCore.IDENTIFIER.MeshComponentManager);\n      return manager.getComponentByEntity(entity);\n    }\n  }, {\n    key: \"setConfig\",\n    value: function setConfig(config) {\n      this.configService.set(config);\n    }\n  }, {\n    key: \"setContainer\",\n    value: function setContainer(container) {\n      this.container = container;\n    }\n  }, {\n    key: \"getContainer\",\n    value: function getContainer() {\n      return this.container;\n    }\n  }, {\n    key: \"createEntity\",\n    value: function createEntity() {\n      return (0, _gWebgpuCore.createEntity)();\n    }\n  }, {\n    key: \"createScene\",\n    value: function createScene() {\n      return this.container.get(_Scene.Scene);\n    }\n  }, {\n    key: \"createCamera\",\n    value: function createCamera() {\n      return this.container.get(_Camera.Camera);\n    }\n  }, {\n    key: \"createView\",\n    value: function createView() {\n      return this.container.get(_View.View);\n    } // public createLight(type: string,) {\n    //   return this.container.getNamed(IDENTIFIER.Light, type)\n    // }\n\n  }, {\n    key: \"createRenderable\",\n    value: function createRenderable(type, config) {\n      var renderable = type ? this.container.getNamed(_gWebgpuCore.IDENTIFIER.Renderable, type) : this.container.get(_Renderable.Renderable);\n      var entity = (0, _gWebgpuCore.createEntity)();\n      renderable.setConfig(config || {});\n      renderable.setEntity(entity);\n      return renderable;\n    }\n  }, {\n    key: \"createGeometry\",\n    value: function createGeometry(type, config) {\n      var geometry = this.container.getNamed(_gWebgpuCore.IDENTIFIER.Geometry, type);\n      var entity = (0, _gWebgpuCore.createEntity)();\n      geometry.setConfig(config || {});\n      geometry.setEntity(entity);\n      return geometry.getComponent();\n    }\n  }, {\n    key: \"createMaterial\",\n    value: function createMaterial(type, config) {\n      var material = this.container.getNamed(_gWebgpuCore.IDENTIFIER.Material, type);\n      var entity = (0, _gWebgpuCore.createEntity)();\n      material.setConfig(config || {});\n      material.setEntity(entity, type);\n      return material.getComponent();\n    }\n  }, {\n    key: \"createTexture2D\",\n    value: function createTexture2D(config) {\n      var texture = this.container.get(_Texture2D.Texture2D);\n      texture.setConfig(config);\n      return texture;\n    }\n  }, {\n    key: \"createBufferGeometry\",\n    value: function createBufferGeometry(params) {\n      var geometrySystem = this.container.getNamed(_gWebgpuCore.IDENTIFIER.Systems, _gWebgpuCore.IDENTIFIER.GeometrySystem);\n      return geometrySystem.createBufferGeometry(params);\n    }\n  }, {\n    key: \"createInstancedBufferGeometry\",\n    value: function createInstancedBufferGeometry(params) {\n      var geometrySystem = this.container.getNamed(_gWebgpuCore.IDENTIFIER.Systems, _gWebgpuCore.IDENTIFIER.GeometrySystem);\n      return geometrySystem.createInstancedBufferGeometry(params);\n    }\n  }, {\n    key: \"createShaderMaterial\",\n    value: function createShaderMaterial(params) {\n      var materialSystem = this.container.getNamed(_gWebgpuCore.IDENTIFIER.Systems, _gWebgpuCore.IDENTIFIER.MaterialSystem);\n      return materialSystem.createShaderMaterial(params);\n    }\n  }, {\n    key: \"createKernel\",\n    value: function createKernel(precompiledBundle) {\n      var kernel = this.container.get(_Kernel.Kernel);\n\n      if (typeof precompiledBundle === 'string') {\n        kernel.setBundle(JSON.parse(precompiledBundle));\n      } else {\n        kernel.setBundle(precompiledBundle);\n      }\n\n      kernel.init();\n      return kernel;\n    }\n  }, {\n    key: \"createRenderer\",\n    value: function createRenderer() {\n      var renderer = this.container.get(_Renderer.Renderer);\n      renderer.container = this.container;\n      renderer.init();\n      return renderer;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var systems = this.container.getAll(_gWebgpuCore.IDENTIFIER.Systems);\n      systems.forEach(function (system) {\n        if (system.tearDown) {\n          system.tearDown();\n        }\n      });\n      var engine = this.container.get(_gWebgpuCore.IDENTIFIER.RenderEngine);\n      engine.destroy();\n      var interactor = this.container.get(_gWebgpuCore.IDENTIFIER.InteractorService);\n      interactor.destroy();\n    }\n  }], [{\n    key: \"create\",\n    value: function create() {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var worldContainer = (0, _gWebgpuCore.createWorldContainer)(); // bind render engine, fallback to WebGL\n\n      var engineClazz = !navigator.gpu ? _gWebgpuEngine.WebGLEngine : _gWebgpuEngine.WebGPUEngine;\n\n      if (!worldContainer.isBound(_gWebgpuCore.IDENTIFIER.RenderEngine)) {\n        worldContainer.bind(_gWebgpuCore.IDENTIFIER.RenderEngine) // @ts-ignore\n        .to(engineClazz).inSingletonScope();\n      }\n\n      worldContainer.bind(_Renderer.Renderer).toSelf();\n      worldContainer.bind(_Kernel.Kernel).toSelf();\n      worldContainer.bind(_Renderable.Renderable).toSelf();\n      worldContainer.bind(_View.View).toSelf();\n      worldContainer.bind(_Camera.Camera).toSelf();\n      worldContainer.bind(_Scene.Scene).toSelf();\n      worldContainer.bind(World).toSelf();\n      worldContainer.bind(_Cache.TextureCache).toSelf();\n      worldContainer.bind(_Texture2D.Texture2D).toSelf(); // bind geometries\n\n      worldContainer.bind(_gWebgpuCore.IDENTIFIER.Geometry).to(_Box.Box).whenTargetNamed(_geometry.Geometry.BOX);\n      worldContainer.bind(_gWebgpuCore.IDENTIFIER.Geometry).to(_Sphere.Sphere).whenTargetNamed(_geometry.Geometry.SPHERE);\n      worldContainer.bind(_gWebgpuCore.IDENTIFIER.Geometry).to(_Plane.Plane).whenTargetNamed(_geometry.Geometry.PLANE);\n      worldContainer.bind(_gWebgpuCore.IDENTIFIER.Geometry).to(_Merged.Merged).whenTargetNamed(_geometry.Geometry.MERGED); // bind materials\n\n      worldContainer.bind(_gWebgpuCore.IDENTIFIER.Material).to(_basic.Basic).whenTargetNamed(_material.Material.BASIC); // bind renderables\n\n      worldContainer.bind(_gWebgpuCore.IDENTIFIER.Renderable).to(_point.Point).whenTargetNamed(_Renderable.Renderable.POINT);\n      worldContainer.bind(_gWebgpuCore.IDENTIFIER.Renderable).to(_line.Line).whenTargetNamed(_Renderable.Renderable.LINE);\n      worldContainer.bind(_gWebgpuCore.IDENTIFIER.Renderable).to(_grid.Grid).whenTargetNamed(_Renderable.Renderable.GRID);\n      var world = worldContainer.get(World);\n      world.setContainer(worldContainer);\n      world.setConfig(config);\n      return world;\n    }\n  }]);\n  return World;\n}(), _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"configService\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.World = World;\n//# sourceMappingURL=World.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Box = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _glMatrix = require(\"gl-matrix\");\n\nvar _inversify = require(\"inversify\");\n\nvar _ = require(\".\");\n\nvar _dec, _class;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar primitiveUv1Padding = 4.0 / 64;\nvar primitiveUv1PaddingScale = 1.0 - primitiveUv1Padding * 2;\nvar\n/**\n * borrow from playcanvas:\n * Creates a procedural box-shaped mesh\n */\nBox = (_dec = (0, _inversify.injectable)(), _dec(_class = /*#__PURE__*/function (_Geometry) {\n  (0, _inherits2.default)(Box, _Geometry);\n\n  var _super = _createSuper(Box);\n\n  function Box() {\n    (0, _classCallCheck2.default)(this, Box);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(Box, [{\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {\n      var _this$config = this.config,\n          _this$config$widthSeg = _this$config.widthSegments,\n          widthSegments = _this$config$widthSeg === void 0 ? 1 : _this$config$widthSeg,\n          _this$config$heightSe = _this$config.heightSegments,\n          heightSegments = _this$config$heightSe === void 0 ? 1 : _this$config$heightSe,\n          _this$config$depthSeg = _this$config.depthSegments,\n          depthSegments = _this$config$depthSeg === void 0 ? 1 : _this$config$depthSeg,\n          _this$config$halfExte = _this$config.halfExtents,\n          halfExtents = _this$config$halfExte === void 0 ? _glMatrix.vec3.fromValues(0.5, 0.5, 0.5) : _this$config$halfExte;\n      var ws = widthSegments;\n      var hs = heightSegments;\n      var ds = depthSegments;\n\n      var _halfExtents = (0, _slicedToArray2.default)(halfExtents, 3),\n          hex = _halfExtents[0],\n          hey = _halfExtents[1],\n          hez = _halfExtents[2];\n\n      var corners = [_glMatrix.vec3.fromValues(-hex, -hey, hez), _glMatrix.vec3.fromValues(hex, -hey, hez), _glMatrix.vec3.fromValues(hex, hey, hez), _glMatrix.vec3.fromValues(-hex, hey, hez), _glMatrix.vec3.fromValues(hex, -hey, -hez), _glMatrix.vec3.fromValues(-hex, -hey, -hez), _glMatrix.vec3.fromValues(-hex, hey, -hez), _glMatrix.vec3.fromValues(hex, hey, -hez)];\n      var faceAxes = [[0, 1, 3], // FRONT\n      [4, 5, 7], // BACK\n      [3, 2, 6], // TOP\n      [1, 0, 4], // BOTTOM\n      [1, 4, 2], // RIGHT\n      [5, 0, 6] // LEFT\n      ];\n      var faceNormals = [[0, 0, 1], // FRONT\n      [0, 0, -1], // BACK\n      [0, 1, 0], // TOP\n      [0, -1, 0], // BOTTOM\n      [1, 0, 0], // RIGHT\n      [-1, 0, 0] // LEFT\n      ];\n      var sides = {\n        FRONT: 0,\n        BACK: 1,\n        TOP: 2,\n        BOTTOM: 3,\n        RIGHT: 4,\n        LEFT: 5\n      };\n      var positions = [];\n      var normals = [];\n      var uvs = [];\n      var uvs1 = [];\n      var indices = [];\n      var vcounter = 0;\n\n      var generateFace = function generateFace(side, uSegments, vSegments) {\n        var u;\n        var v;\n        var i;\n        var j;\n\n        for (i = 0; i <= uSegments; i++) {\n          for (j = 0; j <= vSegments; j++) {\n            var temp1 = _glMatrix.vec3.create();\n\n            var temp2 = _glMatrix.vec3.create();\n\n            var temp3 = _glMatrix.vec3.create();\n\n            var r = _glMatrix.vec3.create();\n\n            _glMatrix.vec3.lerp(temp1, corners[faceAxes[side][0]], corners[faceAxes[side][1]], i / uSegments);\n\n            _glMatrix.vec3.lerp(temp2, corners[faceAxes[side][0]], corners[faceAxes[side][2]], j / vSegments);\n\n            _glMatrix.vec3.sub(temp3, temp2, corners[faceAxes[side][0]]);\n\n            _glMatrix.vec3.add(r, temp1, temp3);\n\n            u = i / uSegments;\n            v = j / vSegments;\n            positions.push(r[0], r[1], r[2]);\n            normals.push(faceNormals[side][0], faceNormals[side][1], faceNormals[side][2]);\n            uvs.push(u, v); // pack as 3x2\n            // 1/3 will be empty, but it's either that or stretched pixels\n            // TODO: generate non-rectangular lightMaps, so we could use space without stretching\n\n            u /= 3;\n            v /= 3;\n            u = u * primitiveUv1PaddingScale + primitiveUv1Padding;\n            v = v * primitiveUv1PaddingScale + primitiveUv1Padding;\n            u += side % 3 / 3;\n            v += Math.floor(side / 3) / 3;\n            uvs1.push(u, v);\n\n            if (i < uSegments && j < vSegments) {\n              indices.push(vcounter + vSegments + 1, vcounter + 1, vcounter);\n              indices.push(vcounter + vSegments + 1, vcounter + vSegments + 2, vcounter + 1);\n            }\n\n            vcounter++;\n          }\n        }\n      };\n\n      generateFace(sides.FRONT, ws, hs);\n      generateFace(sides.BACK, ws, hs);\n      generateFace(sides.TOP, ws, ds);\n      generateFace(sides.BOTTOM, ws, ds);\n      generateFace(sides.RIGHT, ds, hs);\n      generateFace(sides.LEFT, ds, hs); // generate AABB\n\n      var aabb = (0, _gWebgpuCore.generateAABBFromVertices)(positions);\n      var component = this.getComponent();\n      component.indices = Uint32Array.from(indices);\n      component.aabb = aabb;\n      component.vertexCount = vcounter;\n      component.attributes = [{\n        dirty: true,\n        name: 'position',\n        data: Float32Array.from(positions),\n        arrayStride: 4 * 3,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 0,\n          offset: 0,\n          format: 'float3'\n        }]\n      }, {\n        dirty: true,\n        name: 'normal',\n        data: Float32Array.from(normals),\n        arrayStride: 4 * 3,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 1,\n          offset: 0,\n          format: 'float3'\n        }]\n      }, {\n        dirty: true,\n        name: 'uv',\n        data: Float32Array.from(uvs),\n        arrayStride: 4 * 2,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 2,\n          offset: 0,\n          format: 'float2'\n        }]\n      }]; // TODO: barycentric & tangent\n    }\n  }]);\n  return Box;\n}(_.Geometry)) || _class);\nexports.Box = Box;\n//# sourceMappingURL=Box.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Merged = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _ = require(\".\");\n\nvar _isNumber = require(\"../utils/is-number\");\n\nvar _isTypedarray = require(\"../utils/is-typedarray\");\n\nvar _typedarray = require(\"../utils/typedarray\");\n\nvar _dec, _class;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar\n/**\n * merge many geometries into one, use a batch of draw calls\n */\nMerged = (_dec = (0, _inversify.injectable)(), _dec(_class = /*#__PURE__*/function (_Geometry) {\n  (0, _inherits2.default)(Merged, _Geometry);\n\n  var _super = _createSuper(Merged);\n\n  function Merged() {\n    (0, _classCallCheck2.default)(this, Merged);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(Merged, [{\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {\n      var _this$config$geometri = this.config.geometries,\n          geometries = _this$config$geometri === void 0 ? [] : _this$config$geometri;\n      var mergedComponent = this.getComponent();\n      mergedComponent.aabb = new _gWebgpuCore.AABB();\n      var mergedAttributes = [];\n      var mergedIndices = [];\n      var indexOffset = 0;\n      geometries.forEach(function (geometry) {\n        var aabb = geometry.aabb,\n            indices = geometry.indices,\n            vertexCount = geometry.vertexCount,\n            attributes = geometry.attributes; // merge aabb\n\n        mergedComponent.aabb.add(aabb);\n        mergedComponent.vertexCount += vertexCount; // merge indices\n\n        if (indices) {\n          mergedIndices.push.apply(mergedIndices, (0, _toConsumableArray2.default)(indices.map(function (index) {\n            return index + indexOffset;\n          })));\n        }\n\n        indexOffset += vertexCount; // merge attributes\n\n        attributes.forEach(function (attribute, i) {\n          if (!mergedAttributes[i]) {\n            mergedAttributes[i] = attribute;\n            mergedAttributes[i].dirty = true;\n          } else {\n            if (attribute.data) {\n              if ((0, _isNumber.isNumber)(attribute.data)) {\n                // @ts-ignore\n                mergedAttributes[i].push(attribute.data);\n              } else if ((0, _isTypedarray.isTypedArray)(attribute.data)) {\n                // @ts-ignore\n                mergedAttributes[i].data = (0, _typedarray.merge)( // @ts-ignore\n                mergedAttributes[i].data, attribute.data);\n              } else {\n                // @ts-ignore\n                mergedAttributes[i].data = mergedAttributes[i].data.concat(attribute.data);\n              }\n            }\n          }\n        });\n      });\n      mergedComponent.attributes = mergedAttributes;\n      mergedComponent.indices = Uint32Array.from(mergedIndices);\n      mergedComponent.dirty = true;\n    }\n  }]);\n  return Merged;\n}(_.Geometry)) || _class);\nexports.Merged = Merged;\n//# sourceMappingURL=Merged.js.map","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.merge = merge;\n\nfunction merge(a, b) {\n  // Checks for truthy values on both arrays\n  if (!a && !b) {\n    throw new Error('Please specify valid arguments for parameters a and b.');\n  } // Checks for truthy values or empty arrays on each argument\n  // to avoid the unnecessary construction of a new array and\n  // the type comparison\n\n\n  if (!b || b.length === 0) {\n    return a;\n  }\n\n  if (!a || a.length === 0) {\n    return b;\n  } // Make sure that both typed arrays are of the same type\n\n\n  if (Object.prototype.toString.call(a) !== Object.prototype.toString.call(b)) {\n    throw new Error('The types of the two arguments passed for parameters a and b do not match.');\n  } // @ts-ignore\n\n\n  var c = new a.constructor(a.length + b.length);\n  c.set(a);\n  c.set(b, a.length);\n  return c;\n}\n//# sourceMappingURL=typedarray.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Plane = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _ = require(\".\");\n\nvar _dec, _class;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar\n/**\n * borrow from playcanvas\n */\nPlane = (_dec = (0, _inversify.injectable)(), _dec(_class = /*#__PURE__*/function (_Geometry) {\n  (0, _inherits2.default)(Plane, _Geometry);\n\n  var _super = _createSuper(Plane);\n\n  function Plane() {\n    (0, _classCallCheck2.default)(this, Plane);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(Plane, [{\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {\n      var _this$config = this.config,\n          _this$config$halfExte = _this$config.halfExtents,\n          halfExtents = _this$config$halfExte === void 0 ? [0.5, 0.5] : _this$config$halfExte,\n          _this$config$widthSeg = _this$config.widthSegments,\n          widthSegments = _this$config$widthSeg === void 0 ? 5 : _this$config$widthSeg,\n          _this$config$lengthSe = _this$config.lengthSegments,\n          lengthSegments = _this$config$lengthSe === void 0 ? 5 : _this$config$lengthSe;\n      var positions = [];\n      var normals = [];\n      var uvs = [];\n      var indices = [];\n      var vcounter = 0;\n\n      for (var i = 0; i <= widthSegments; i++) {\n        for (var j = 0; j <= lengthSegments; j++) {\n          var x = -halfExtents[0] + 2.0 * halfExtents[0] * i / widthSegments;\n          var y = 0.0;\n          var z = -(-halfExtents[1] + 2.0 * halfExtents[1] * j / lengthSegments);\n          var u = i / widthSegments;\n          var v = j / lengthSegments;\n          positions.push(x, y, z);\n          normals.push(0.0, 1.0, 0.0);\n          uvs.push(u, v);\n\n          if (i < widthSegments && j < lengthSegments) {\n            indices.push(vcounter + lengthSegments + 1, vcounter + 1, vcounter);\n            indices.push(vcounter + lengthSegments + 1, vcounter + lengthSegments + 2, vcounter + 1);\n          }\n\n          vcounter++;\n        }\n      } // generate AABB\n\n\n      var aabb = (0, _gWebgpuCore.generateAABBFromVertices)(positions);\n      var component = this.getComponent();\n      component.indices = Uint32Array.from(indices);\n      component.aabb = aabb;\n      component.vertexCount = vcounter;\n      component.attributes = [{\n        dirty: true,\n        name: 'position',\n        data: Float32Array.from(positions),\n        arrayStride: 4 * 3,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 0,\n          offset: 0,\n          format: 'float3'\n        }]\n      }, {\n        dirty: true,\n        name: 'normal',\n        data: Float32Array.from(normals),\n        arrayStride: 4 * 3,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 1,\n          offset: 0,\n          format: 'float3'\n        }]\n      }, {\n        dirty: true,\n        name: 'uv',\n        data: Float32Array.from(uvs),\n        arrayStride: 4 * 2,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 2,\n          offset: 0,\n          format: 'float2'\n        }]\n      }]; // TODO: barycentric & tangent\n    }\n  }]);\n  return Plane;\n}(_.Geometry)) || _class);\nexports.Plane = Plane;\n//# sourceMappingURL=Plane.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Sphere = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _ = require(\".\");\n\nvar _dec, _class;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar\n/**\n * borrow from playcanvas\n */\nSphere = (_dec = (0, _inversify.injectable)(), _dec(_class = /*#__PURE__*/function (_Geometry) {\n  (0, _inherits2.default)(Sphere, _Geometry);\n\n  var _super = _createSuper(Sphere);\n\n  function Sphere() {\n    (0, _classCallCheck2.default)(this, Sphere);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(Sphere, [{\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {\n      var _this$config = this.config,\n          _this$config$radius = _this$config.radius,\n          radius = _this$config$radius === void 0 ? 0.5 : _this$config$radius,\n          _this$config$latitude = _this$config.latitudeBands,\n          latitudeBands = _this$config$latitude === void 0 ? 16 : _this$config$latitude,\n          _this$config$longitud = _this$config.longitudeBands,\n          longitudeBands = _this$config$longitud === void 0 ? 16 : _this$config$longitud;\n      var positions = [];\n      var normals = [];\n      var uvs = [];\n      var indices = [];\n\n      for (var lat = 0; lat <= latitudeBands; lat++) {\n        var theta = lat * Math.PI / latitudeBands;\n        var sinTheta = Math.sin(theta);\n        var cosTheta = Math.cos(theta);\n\n        for (var lon = 0; lon <= longitudeBands; lon++) {\n          // Sweep the sphere from the positive Z axis to match a 3DS Max sphere\n          var phi = lon * 2 * Math.PI / longitudeBands - Math.PI / 2.0;\n          var sinPhi = Math.sin(phi);\n          var cosPhi = Math.cos(phi);\n          var x = cosPhi * sinTheta;\n          var y = cosTheta;\n          var z = sinPhi * sinTheta;\n          var u = 1.0 - lon / longitudeBands;\n          var v = 1.0 - lat / latitudeBands;\n          positions.push(x * radius, y * radius, z * radius);\n          normals.push(x, y, z);\n          uvs.push(u, v);\n        }\n      }\n\n      for (var _lat = 0; _lat < latitudeBands; ++_lat) {\n        for (var _lon = 0; _lon < longitudeBands; ++_lon) {\n          var first = _lat * (longitudeBands + 1) + _lon;\n          var second = first + longitudeBands + 1;\n          indices.push(first + 1, second, first);\n          indices.push(first + 1, second + 1, second);\n        }\n      } // generate AABB\n\n\n      var aabb = (0, _gWebgpuCore.generateAABBFromVertices)(positions);\n      var component = this.getComponent();\n      component.indices = Uint32Array.from(indices);\n      component.aabb = aabb;\n      component.vertexCount = positions.length / 3;\n      component.attributes = [{\n        dirty: true,\n        name: 'position',\n        data: Float32Array.from(positions),\n        arrayStride: 4 * 3,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 0,\n          offset: 0,\n          format: 'float3'\n        }]\n      }, {\n        dirty: true,\n        name: 'normal',\n        data: Float32Array.from(normals),\n        arrayStride: 4 * 3,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 1,\n          offset: 0,\n          format: 'float3'\n        }]\n      }, {\n        dirty: true,\n        name: 'uv',\n        data: Float32Array.from(uvs),\n        arrayStride: 4 * 2,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 2,\n          offset: 0,\n          format: 'float2'\n        }]\n      }]; // TODO: barycentric & tangent\n    }\n  }]);\n  return Sphere;\n}(_.Geometry)) || _class);\nexports.Sphere = Sphere;\n//# sourceMappingURL=Sphere.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Basic = void 0;\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _glMatrix = require(\"gl-matrix\");\n\nvar _inversify = require(\"inversify\");\n\nvar _ = require(\"..\");\n\nvar _dec, _dec2, _dec3, _class, _class2, _descriptor, _descriptor2, _temp;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/* babel-plugin-inline-import './shaders/webgl.basic.frag.glsl' */\nvar webglFragmentShaderGLSL = \"varying vec4 fragColor;\\n\\n#pragma include \\\"uv.frag.declaration\\\"\\n#pragma include \\\"map.frag.declaration\\\"\\n\\nvoid main() {\\n  vec4 diffuseColor = fragColor;\\n\\n  #pragma include \\\"map.frag.main\\\"\\n\\n  gl_FragColor = diffuseColor;\\n}\";\n\n/* babel-plugin-inline-import './shaders/webgl.basic.vert.glsl' */\nvar webglVertexShaderGLSL = \"attribute vec3 position;\\nattribute vec3 normal;\\n\\nuniform mat4 projectionMatrix;\\nuniform mat4 modelViewMatrix;\\nuniform vec4 color;\\n\\nvarying vec4 fragColor;\\n\\n#pragma include \\\"uv.vert.declaration\\\"\\n\\nvoid main() {\\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\\n  fragColor = color;\\n\\n  #pragma include \\\"uv.vert.main\\\"\\n}\";\n\n/* babel-plugin-inline-import './shaders/webgpu.basic.frag.glsl' */\nvar webgpuFragmentShaderGLSL = \"// layout(set = 0, binding = 1) uniform WireframeUniforms {\\n//   float lineWidth;\\n//   vec4 lineColor;\\n// } wireframe;\\n\\nlayout(location = 0) in vec4 fragColor;\\n// layout(location = 1) in vec3 v_Barycentric;\\n\\nlayout(location = 0) out vec4 outColor;\\n\\n// wireframe\\n// float edgeFactor() {\\n//   vec3 d = fwidth(v_Barycentric);\\n//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);\\n//   return min(min(a3.x, a3.y), a3.z);\\n// }\\n\\nvoid main() {\\n  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));\\n  outColor = fragColor;\\n}\";\n\n/* babel-plugin-inline-import './shaders/webgpu.basic.vert.glsl' */\nvar webgpuVertexShaderGLSL = \"layout(set = 0, binding = 0) uniform Uniforms {\\n  vec4 color;\\n  mat4 projectionMatrix;\\n  mat4 modelViewMatrix;\\n} uniforms;\\n\\nlayout(location = 0) in vec3 position;\\n// layout(location = 1) in vec3 barycentric;\\n\\nlayout(location = 0) out vec4 fragColor;\\n// layout(location = 1) out vec3 v_Barycentric;\\n\\nvoid main() {\\n  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);\\n  fragColor = uniforms.color;\\n  // v_Barycentric = barycentric;\\n}\";\nvar\n/**\n * This material is not affected by lights.\n * @see https://threejs.org/docs/#api/en/materials/MeshBasicMaterial\n */\nBasic = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.RenderEngine), _dec3 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.ShaderModuleService), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function (_Material) {\n  (0, _inherits2.default)(Basic, _Material);\n\n  var _super = _createSuper(Basic);\n\n  function Basic() {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, Basic);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    (0, _initializerDefineProperty2.default)(_this, \"engine\", _descriptor, (0, _assertThisInitialized2.default)(_this));\n    (0, _initializerDefineProperty2.default)(_this, \"shaderModuleService\", _descriptor2, (0, _assertThisInitialized2.default)(_this));\n    return _this;\n  }\n\n  (0, _createClass2.default)(Basic, [{\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {\n      var component = this.getComponent();\n      var vertexShaderGLSL = this.engine.supportWebGPU ? webgpuVertexShaderGLSL : webglVertexShaderGLSL;\n      var fragmentShaderGLSL = this.engine.supportWebGPU ? webgpuFragmentShaderGLSL : webglFragmentShaderGLSL;\n      this.shaderModuleService.registerModule('material-basic', {\n        vs: vertexShaderGLSL,\n        fs: fragmentShaderGLSL\n      });\n\n      var _this$shaderModuleSer = this.shaderModuleService.getModule('material-basic'),\n          vs = _this$shaderModuleSer.vs,\n          fs = _this$shaderModuleSer.fs,\n          extractedUniforms = _this$shaderModuleSer.uniforms;\n\n      component.vertexShaderGLSL = vs;\n      component.fragmentShaderGLSL = fs; // @ts-ignore\n\n      component.setUniform(extractedUniforms);\n\n      if (this.config.map) {\n        component.setDefines({\n          USE_UV: 1,\n          USE_MAP: 1\n        });\n        component.setUniform({\n          // @ts-ignore\n          map: this.config.map,\n          uvTransform: _glMatrix.mat3.create()\n        });\n      }\n    }\n  }]);\n  return Basic;\n}(_.Material), _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"engine\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"shaderModuleService\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Basic = Basic;\n//# sourceMappingURL=index.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Grid = void 0;\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _Renderable2 = require(\"../Renderable\");\n\nvar _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _class, _class2, _descriptor, _descriptor2, _descriptor3, _temp;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/* babel-plugin-inline-import './shaders/webgl.grid.frag.glsl' */\nvar gridFrag = \"// generate grid, borrow from clay.gl viewer\\n// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl\\n#extension GL_OES_standard_derivatives : enable\\n\\nvarying vec3 v_Position;\\n// varying vec3 v_Normal;\\n\\nuniform float u_GridSize : 5;\\nuniform float u_GridSize2 : .5;\\nuniform vec4 u_GridColor : [0, 0, 0, 1];\\nuniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];\\nuniform bool u_GridEnabled : true;\\n\\n// uniform vec3 u_LightDirection;\\n// uniform vec3 u_LightColor;\\n// uniform vec3 u_Camera;\\n\\nvoid main() {\\n  // vec3 n = v_Normal;\\n  // vec3 l = normalize(u_LightDirection);\\n  // float NdotL = clamp(dot(n, l), 0.001, 1.0);\\n\\n  gl_FragColor = vec4(1.);\\n\\n  if (u_GridEnabled) {\\n    float wx = v_Position.x;\\n    float wz = v_Position.z;\\n    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;\\n    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;\\n\\n    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;\\n    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;\\n\\n    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);\\n    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);\\n    // if (v0 > 0.1) {\\n        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);\\n    // }\\n    // else {\\n        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);\\n    // }\\n  }\\n\\n  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);\\n  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;\\n\\n  // gl_FragColor.rgb *= diffuseColor;\\n}\";\n\n/* babel-plugin-inline-import './shaders/webgl.grid.vert.glsl' */\nvar gridVert = \"attribute vec3 a_Position;\\n\\nvarying vec3 v_Position;\\n\\nuniform mat4 projectionMatrix;\\nuniform mat4 modelViewMatrix;\\n\\nvoid main() {\\n  v_Position = a_Position;\\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);\\n}\";\nvar Grid = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.Systems), _dec3 = (0, _inversify.named)(_gWebgpuCore.IDENTIFIER.MaterialSystem), _dec4 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.Systems), _dec5 = (0, _inversify.named)(_gWebgpuCore.IDENTIFIER.GeometrySystem), _dec6 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.ShaderModuleService), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function (_Renderable) {\n  (0, _inherits2.default)(Grid, _Renderable);\n\n  var _super = _createSuper(Grid);\n\n  function Grid() {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, Grid);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    (0, _initializerDefineProperty2.default)(_this, \"materialSystem\", _descriptor, (0, _assertThisInitialized2.default)(_this));\n    (0, _initializerDefineProperty2.default)(_this, \"geometrySystem\", _descriptor2, (0, _assertThisInitialized2.default)(_this));\n    (0, _initializerDefineProperty2.default)(_this, \"shaderModuleService\", _descriptor3, (0, _assertThisInitialized2.default)(_this));\n    return _this;\n  }\n\n  (0, _createClass2.default)(Grid, [{\n    key: \"onAttributeChanged\",\n    value: function onAttributeChanged(_ref) {\n      var name = _ref.name,\n          data = _ref.data;\n      var mesh = this.getMeshComponent();\n\n      if (mesh && mesh.material) {\n        if (name === 'gridColor') {\n          mesh.material.setUniform('u_GridColor', data);\n          mesh.material.setUniform('u_GridColor2', data);\n        } else if (name === 'gridSize') {\n          mesh.material.setUniform('u_GridSize', data);\n          mesh.material.setUniform('u_GridSize2', data);\n        }\n      }\n    }\n  }, {\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {\n      this.shaderModuleService.registerModule('grid', {\n        vs: gridVert,\n        fs: gridFrag\n      });\n\n      var _this$shaderModuleSer = this.shaderModuleService.getModule('grid'),\n          vs = _this$shaderModuleSer.vs,\n          fs = _this$shaderModuleSer.fs,\n          extractedUniforms = _this$shaderModuleSer.uniforms;\n\n      var material = this.materialSystem.createShaderMaterial({\n        vertexShader: vs,\n        fragmentShader: fs\n      });\n      this.setMaterial(material);\n      var geometry = this.geometrySystem.createBufferGeometry({\n        vertexCount: 4\n      });\n      this.setGeometry(geometry);\n      material.setCull({\n        enable: false,\n        face: _gWebgpuCore.gl.BACK\n      }).setDepth({\n        enable: true,\n        func: _gWebgpuCore.gl.LESS\n      }); // @ts-ignore\n\n      material.setUniform(extractedUniforms);\n      this.setAttributes({\n        gridColor: this.config.gridColor,\n        gridSize: this.config.gridSize\n      });\n      geometry.setIndex([0, 3, 2, 2, 1, 0]);\n      geometry.setAttribute('a_Position', Float32Array.from([-4, -1, -4, 4, -1, -4, 4, -1, 4, -4, -1, 4]), {\n        arrayStride: 4 * 2,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 0,\n          offset: 0,\n          format: 'float2'\n        }]\n      });\n    }\n  }]);\n  return Grid;\n}(_Renderable2.Renderable), _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"materialSystem\", [_dec2, _dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"geometrySystem\", [_dec4, _dec5], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"shaderModuleService\", [_dec6], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Grid = Grid;\n//# sourceMappingURL=index.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Line = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _polylineNormals = _interopRequireDefault(require(\"../../utils/polyline-normals\"));\n\nvar _Renderable2 = require(\"../Renderable\");\n\nvar _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _class, _class2, _descriptor, _descriptor2, _descriptor3, _temp;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/* babel-plugin-inline-import './shaders/webgl.line.frag.glsl' */\nvar lineFrag = \"uniform float u_dash_array : 0.02;\\nuniform float u_dash_offset : 0;\\nuniform float u_dash_ratio : 0;\\nuniform float u_thickness : 0.02;\\n\\nvarying vec4 v_color;\\nvarying vec2 v_normal;\\nvarying float v_counters;\\n\\nvoid main() {\\n    float blur = 1. - smoothstep(0.98, 1., length(v_normal));\\n\\n    gl_FragColor = v_color;\\n    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));\\n}\";\n\n/* babel-plugin-inline-import './shaders/webgl.line.vert.glsl' */\nvar lineVert = \"attribute vec2 a_pos;\\nattribute vec4 a_color;\\nattribute float a_line_miter;\\nattribute vec2 a_line_normal;\\nattribute float a_counters;\\n\\nuniform mat4 projectionMatrix;\\nuniform mat4 modelViewMatrix;\\nuniform float u_thickness : 0.02;\\nuniform vec2 u_viewport;\\n\\nvarying vec4 v_color;\\nvarying vec2 v_normal;\\nvarying float v_counters;\\n\\nvoid main() {\\n  v_color = a_color;\\n  v_counters = a_counters;\\n\\n  vec3 normal = normalize(vec3(a_line_normal, 0.0));\\n\\n  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);\\n\\n  v_normal = vec2(normal * sign(a_line_miter));\\n\\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;\\n}\\n\";\nvar Line = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.Systems), _dec3 = (0, _inversify.named)(_gWebgpuCore.IDENTIFIER.MaterialSystem), _dec4 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.Systems), _dec5 = (0, _inversify.named)(_gWebgpuCore.IDENTIFIER.GeometrySystem), _dec6 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.ShaderModuleService), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function (_Renderable) {\n  (0, _inherits2.default)(Line, _Renderable);\n\n  var _super = _createSuper(Line);\n\n  function Line() {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, Line);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    (0, _initializerDefineProperty2.default)(_this, \"materialSystem\", _descriptor, (0, _assertThisInitialized2.default)(_this));\n    (0, _initializerDefineProperty2.default)(_this, \"geometrySystem\", _descriptor2, (0, _assertThisInitialized2.default)(_this));\n    (0, _initializerDefineProperty2.default)(_this, \"shaderModuleService\", _descriptor3, (0, _assertThisInitialized2.default)(_this));\n    _this.vertexCount = void 0;\n    return _this;\n  }\n\n  (0, _createClass2.default)(Line, [{\n    key: \"onAttributeChanged\",\n    value: function onAttributeChanged(_ref) {\n      var name = _ref.name,\n          data = _ref.data;\n      var mesh = this.getMeshComponent();\n\n      if (mesh && mesh.material) {\n        switch (name) {\n          case 'dashArray':\n            mesh.material.setUniform('u_dash_array', data);\n            break;\n\n          case 'dashOffset':\n            mesh.material.setUniform('u_dash_offset', data);\n            break;\n\n          case 'dashRatio':\n            mesh.material.setUniform('u_dash_ratio', data);\n            break;\n\n          case 'thickness':\n            mesh.material.setUniform('u_thickness', data);\n            break;\n\n          case 'color':\n            var colors = new Array(this.vertexCount).fill(undefined).map(function () {\n              return data;\n            }).reduce(function (prev, cur) {\n              // @ts-ignore\n              return [].concat((0, _toConsumableArray2.default)(prev), (0, _toConsumableArray2.default)(cur));\n            }, []); // @ts-ignore\n\n            mesh.geometry.setAttribute('a_color', Float32Array.from(colors), {\n              arrayStride: 4 * 4,\n              stepMode: 'vertex',\n              attributes: [{\n                shaderLocation: 1,\n                offset: 0,\n                format: 'float4'\n              }]\n            });\n            break;\n        }\n      }\n    }\n  }, {\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {\n      var _this2 = this;\n\n      this.shaderModuleService.registerModule('line', {\n        vs: lineVert,\n        fs: lineFrag\n      });\n\n      var _this$shaderModuleSer = this.shaderModuleService.getModule('line'),\n          vs = _this$shaderModuleSer.vs,\n          fs = _this$shaderModuleSer.fs,\n          extractedUniforms = _this$shaderModuleSer.uniforms;\n\n      var material = this.materialSystem.createShaderMaterial({\n        vertexShader: vs,\n        fragmentShader: fs\n      });\n\n      var _getNormals = (0, _polylineNormals.default)(this.config.points, false),\n          normals = _getNormals.normals,\n          attrIndex = _getNormals.attrIndex,\n          attrPos = _getNormals.attrPos,\n          attrCounters = _getNormals.attrCounters;\n\n      var vertexCount = attrPos.length;\n      this.vertexCount = vertexCount;\n      var geometry = this.geometrySystem.createBufferGeometry({\n        vertexCount: vertexCount\n      });\n      this.setMaterial(material);\n      this.setGeometry(geometry);\n      material.setCull({\n        enable: false,\n        face: _gWebgpuCore.gl.BACK\n      }) // @ts-ignore\n      .setUniform(extractedUniforms);\n      this.setAttributes({\n        dashArray: this.config.dashArray,\n        dashOffset: this.config.dashOffset,\n        dashRatio: this.config.dashRatio,\n        thickness: this.config.thickness\n      });\n      var attrNormal = [];\n      var attrMiter = [];\n      normals.forEach(function (n) {\n        var norm = n[0];\n        var miter = n[1];\n        attrNormal.push([norm[0], norm[1]]); // @ts-ignore\n\n        attrMiter.push(miter);\n      }); // [[0,1,2], [2,1,3]]\n\n      geometry.setIndex(attrIndex.reduce(function (prev, cur) {\n        return [].concat((0, _toConsumableArray2.default)(prev), (0, _toConsumableArray2.default)(cur));\n      }, []));\n      geometry.setAttribute('a_pos', Float32Array.from(attrPos.reduce(function (prev, cur) {\n        return [].concat((0, _toConsumableArray2.default)(prev), (0, _toConsumableArray2.default)(cur));\n      }, [])), {\n        arrayStride: 4 * 2,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 0,\n          offset: 0,\n          format: 'float2'\n        }]\n      });\n      var colors = new Array(vertexCount).fill(undefined).map(function () {\n        return (0, _toConsumableArray2.default)(_this2.config.color);\n      }).reduce(function (prev, cur) {\n        return [].concat((0, _toConsumableArray2.default)(prev), (0, _toConsumableArray2.default)(cur));\n      }, []);\n      geometry.setAttribute('a_color', Float32Array.from(colors), {\n        arrayStride: 4 * 4,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 1,\n          offset: 0,\n          format: 'float4'\n        }]\n      });\n      geometry.setAttribute('a_line_miter', Float32Array.from(attrMiter), {\n        arrayStride: 4 * 1,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 2,\n          offset: 0,\n          format: 'float'\n        }]\n      });\n      geometry.setAttribute('a_line_normal', Float32Array.from(attrNormal.reduce(function (prev, cur) {\n        return [].concat((0, _toConsumableArray2.default)(prev), (0, _toConsumableArray2.default)(cur));\n      }, [])), {\n        arrayStride: 4 * 2,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 3,\n          offset: 0,\n          format: 'float2'\n        }]\n      });\n      geometry.setAttribute('a_counters', Float32Array.from(attrCounters), {\n        arrayStride: 4 * 1,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 4,\n          offset: 0,\n          format: 'float'\n        }]\n      });\n    }\n  }]);\n  return Line;\n}(_Renderable2.Renderable), _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"materialSystem\", [_dec2, _dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"geometrySystem\", [_dec4, _dec5], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"shaderModuleService\", [_dec6], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Line = Line;\n//# sourceMappingURL=index.js.map","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = _default;\n\nvar _glVec = require(\"gl-vec2\");\n\nvar _polylineMiterUtil = require(\"polyline-miter-util\");\n\n// @ts-ignore\n// @ts-ignore\nfunction extrusions(positions, out, point, normal, scale) {\n  addNext(out, normal, -scale);\n  addNext(out, normal, scale);\n  positions.push(point);\n  positions.push(point);\n}\n\nfunction addNext(out, normal, length) {\n  out.push([[normal[0], normal[1]], length]);\n}\n\nfunction _default(points, closed, indexOffset) {\n  var lineA = [0, 0];\n  var lineB = [0, 0];\n  var tangent = [0, 0];\n  var miter = [0, 0];\n\n  var _lastFlip = -1;\n\n  var _started = false;\n  var _normal = null;\n  var tmp = (0, _glVec.create)();\n  var count = indexOffset || 0;\n  var miterLimit = 3;\n  var out = [];\n  var attrPos = [];\n  var attrIndex = [];\n  var attrCounters = [0, 0];\n\n  if (closed) {\n    points = points.slice();\n    points.push(points[0]);\n  }\n\n  var total = points.length;\n\n  for (var i = 1; i < total; i++) {\n    var index = count;\n    var last = points[i - 1];\n    var cur = points[i];\n    var next = i < points.length - 1 ? points[i + 1] : null;\n    attrCounters.push(i / total, i / total);\n    (0, _polylineMiterUtil.direction)(lineA, cur, last);\n\n    if (!_normal) {\n      _normal = [0, 0];\n      (0, _polylineMiterUtil.normal)(_normal, lineA);\n    }\n\n    if (!_started) {\n      _started = true;\n      extrusions(attrPos, out, last, _normal, 1);\n    }\n\n    attrIndex.push([index + 0, index + 1, index + 2]);\n\n    if (!next) {\n      // no miter, simple segment\n      (0, _polylineMiterUtil.normal)(_normal, lineA); // reset normal\n\n      extrusions(attrPos, out, cur, _normal, 1);\n      attrIndex.push(_lastFlip === 1 ? [index, index + 2, index + 3] : [index + 2, index + 1, index + 3]);\n      count += 2;\n    } else {\n      // miter with last\n      // get unit dir of next line\n      (0, _polylineMiterUtil.direction)(lineB, next, cur); // stores tangent & miter\n\n      var miterLen = (0, _polylineMiterUtil.computeMiter)(tangent, miter, lineA, lineB, 1); // get orientation\n\n      var flip = (0, _glVec.dot)(tangent, _normal) < 0 ? -1 : 1;\n      var bevel = miterLen > miterLimit; // 处理相邻线段重叠的情况\n\n      if (!isFinite(miterLen)) {\n        (0, _polylineMiterUtil.normal)(_normal, lineA); // reset normal\n\n        extrusions(attrPos, out, cur, _normal, 1);\n        attrIndex.push(_lastFlip === 1 ? [index, index + 2, index + 3] : [index + 2, index + 1, index + 3]);\n        count += 2;\n        _lastFlip = flip;\n        continue;\n      }\n\n      if (bevel) {\n        miterLen = miterLimit;\n        attrCounters.push(i / total); // next two points in our first segment\n\n        addNext(out, _normal, -flip);\n        attrPos.push(cur);\n        addNext(out, miter, miterLen * flip);\n        attrPos.push(cur);\n        attrIndex.push(_lastFlip !== -flip ? [index, index + 2, index + 3] : [index + 2, index + 1, index + 3]); // now add the bevel triangle\n\n        attrIndex.push([index + 2, index + 3, index + 4]);\n        (0, _polylineMiterUtil.normal)(tmp, lineB);\n        (0, _glVec.copy)(_normal, tmp); // store normal for next round\n\n        addNext(out, _normal, -flip);\n        attrPos.push(cur); // the miter is now the normal for our next join\n\n        count += 3;\n      } else {\n        // miter\n        // next two points for our miter join\n        extrusions(attrPos, out, cur, miter, miterLen);\n        attrIndex.push(_lastFlip === 1 ? [index, index + 2, index + 3] : [index + 2, index + 1, index + 3]);\n        flip = -1; // the miter is now the normal for our next join\n\n        (0, _glVec.copy)(_normal, miter);\n        count += 2;\n      }\n\n      _lastFlip = flip;\n    }\n  }\n\n  return {\n    normals: out,\n    attrIndex: attrIndex,\n    attrPos: attrPos,\n    attrCounters: attrCounters\n  };\n}\n//# sourceMappingURL=polyline-normals.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Point = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _picking = require(\"../../utils/picking\");\n\nvar _Renderable2 = require(\"../Renderable\");\n\nvar _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _class, _class2, _descriptor, _descriptor2, _descriptor3, _temp;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/* babel-plugin-inline-import './shaders/webgl.point.frag.glsl' */\nvar pointFrag = \"uniform float u_blur : 0.05;\\nuniform float u_opacity : 0.7;\\nuniform float u_stroke_width : 0.01;\\nuniform vec4 u_stroke_color : [0, 0, 0, 0];\\nuniform float u_stroke_opacity : 1;\\n\\nvarying vec4 v_color;\\nvarying vec4 v_data;\\nvarying float v_radius;\\n\\n#pragma include \\\"sdf2d\\\"\\n#pragma include \\\"picking\\\"\\n\\nvoid main() {\\n  int shape = int(floor(v_data.w + 0.5));\\n\\n  float antialiasblur = v_data.z;\\n  float antialiased_blur = -max(u_blur, antialiasblur);\\n  float r = v_radius / (v_radius + u_stroke_width);\\n\\n  float outer_df;\\n  float inner_df;\\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\\n  // if (shape == 0) {\\n    outer_df = sdCircle(v_data.xy, 1.0);\\n    inner_df = sdCircle(v_data.xy, r);\\n  // } else if (shape == 1) {\\n  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\\n  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\\n  // } else if (shape == 2) {\\n  //   outer_df = sdBox(v_data.xy, vec2(1.));\\n  //   inner_df = sdBox(v_data.xy, vec2(r));\\n  // } else if (shape == 3) {\\n  //   outer_df = sdPentagon(v_data.xy, 0.8);\\n  //   inner_df = sdPentagon(v_data.xy, r * 0.8);\\n  // } else if (shape == 4) {\\n  //   outer_df = sdHexagon(v_data.xy, 0.8);\\n  //   inner_df = sdHexagon(v_data.xy, r * 0.8);\\n  // } else if (shape == 5) {\\n  //   outer_df = sdOctogon(v_data.xy, 1.0);\\n  //   inner_df = sdOctogon(v_data.xy, r);\\n  // } else if (shape == 6) {\\n  //   outer_df = sdHexagram(v_data.xy, 0.52);\\n  //   inner_df = sdHexagram(v_data.xy, r * 0.52);\\n  // } else if (shape == 7) {\\n  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));\\n  //   inner_df = sdRhombus(v_data.xy, vec2(r));\\n  // } else if (shape == 8) {\\n  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);\\n  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\\n  // }\\n\\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\\n\\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\\n    antialiased_blur,\\n    0.0,\\n    inner_df\\n  );\\n  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;\\n\\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\\n\\n  gl_FragColor = filterColor(gl_FragColor);\\n}\";\n\n/* babel-plugin-inline-import './shaders/webgl.point.vert.glsl' */\nvar pointVert = \"attribute vec2 position;\\nattribute vec4 color;\\nattribute float shape;\\nattribute vec2 offset;\\nattribute float size;\\n\\nuniform mat4 projectionMatrix;\\nuniform mat4 modelViewMatrix;\\n\\nuniform float u_stroke_width : 0.01;\\nuniform float u_device_pixel_ratio;\\nuniform vec2 u_viewport;\\n\\nvarying vec4 v_color;\\nvarying vec4 v_data;\\nvarying float v_radius;\\n\\n#pragma include \\\"picking\\\"\\n\\nvoid main() {\\n  v_color = color;\\n  v_radius = size;\\n\\n  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);\\n\\n  // construct point coords\\n  v_data = vec4(position, antialiasblur, shape);\\n\\n  gl_Position = projectionMatrix * modelViewMatrix\\n    * vec4(position * size + offset, 0.0, 1.0);\\n\\n  setPickingColor(a_PickingColor);\\n}\";\nvar pointShapes = ['circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'];\n\n/**\n * Use SDF to draw 2D point with stroke.\n */\nvar Point = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.Systems), _dec3 = (0, _inversify.named)(_gWebgpuCore.IDENTIFIER.MaterialSystem), _dec4 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.Systems), _dec5 = (0, _inversify.named)(_gWebgpuCore.IDENTIFIER.GeometrySystem), _dec6 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.ShaderModuleService), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function (_Renderable) {\n  (0, _inherits2.default)(Point, _Renderable);\n\n  var _super = _createSuper(Point);\n\n  function Point() {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, Point);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    (0, _initializerDefineProperty2.default)(_this, \"materialSystem\", _descriptor, (0, _assertThisInitialized2.default)(_this));\n    (0, _initializerDefineProperty2.default)(_this, \"geometrySystem\", _descriptor2, (0, _assertThisInitialized2.default)(_this));\n    (0, _initializerDefineProperty2.default)(_this, \"shaderModuleService\", _descriptor3, (0, _assertThisInitialized2.default)(_this));\n    return _this;\n  }\n\n  (0, _createClass2.default)(Point, [{\n    key: \"onAttributeChanged\",\n    value: function onAttributeChanged(_ref) {\n      var name = _ref.name,\n          data = _ref.data;\n      var mesh = this.getMeshComponent();\n\n      if (mesh && mesh.material) {\n        if (name === 'strokeWidth') {\n          mesh.material.setUniform('u_stroke_width', data);\n        } else if (name === 'strokeColor') {\n          mesh.material.setUniform('u_stroke_color', data);\n        } else if (name === 'strokeOpacity') {\n          mesh.material.setUniform('u_stroke_opacity', data);\n        } else if (name === 'opacity') {\n          mesh.material.setUniform('u_opacity', data);\n        } else if (name === 'blur') {\n          mesh.material.setUniform('u_blur', data);\n        }\n      }\n    }\n  }, {\n    key: \"onEntityCreated\",\n    value: function onEntityCreated() {\n      this.shaderModuleService.registerModule('grid', {\n        vs: pointVert,\n        fs: pointFrag\n      });\n\n      var _this$shaderModuleSer = this.shaderModuleService.getModule('grid'),\n          vs = _this$shaderModuleSer.vs,\n          fs = _this$shaderModuleSer.fs,\n          extractedUniforms = _this$shaderModuleSer.uniforms;\n\n      var material = this.materialSystem.createShaderMaterial({\n        vertexShader: vs,\n        fragmentShader: fs,\n        cull: {\n          enable: false\n        },\n        depth: {\n          enable: false\n        },\n        blend: {\n          enable: true,\n          func: {\n            srcRGB: _gWebgpuCore.gl.SRC_ALPHA,\n            dstRGB: _gWebgpuCore.gl.ONE_MINUS_SRC_ALPHA,\n            srcAlpha: 1,\n            dstAlpha: 1\n          }\n        }\n      }); // TODO: support define stroke-relative props per point\n\n      material.setUniform(_objectSpread({\n        u_device_pixel_ratio: window.devicePixelRatio\n      }, extractedUniforms));\n      var attributes = this.buildAttributes();\n      var geometry = this.geometrySystem.createInstancedBufferGeometry({\n        maxInstancedCount: attributes.instancedOffsets.length / 2,\n        vertexCount: 6\n      });\n      geometry.setIndex([0, 2, 1, 0, 3, 2]);\n      geometry.setAttribute('position', Float32Array.from(attributes.positions), {\n        arrayStride: 4 * 2,\n        stepMode: 'vertex',\n        attributes: [{\n          shaderLocation: 0,\n          offset: 0,\n          format: 'float2'\n        }]\n      });\n      geometry.setAttribute('offset', Float32Array.from(attributes.instancedOffsets), {\n        arrayStride: 4 * 2,\n        stepMode: 'instance',\n        attributes: [{\n          shaderLocation: 1,\n          offset: 0,\n          format: 'float2'\n        }]\n      });\n      geometry.setAttribute('color', Float32Array.from(attributes.instancedColors), {\n        arrayStride: 4 * 4,\n        stepMode: 'instance',\n        attributes: [{\n          shaderLocation: 2,\n          offset: 0,\n          format: 'float4'\n        }]\n      });\n      geometry.setAttribute('size', Float32Array.from(attributes.instancedSizes), {\n        arrayStride: 4,\n        stepMode: 'instance',\n        attributes: [{\n          shaderLocation: 3,\n          offset: 0,\n          format: 'float'\n        }]\n      });\n      geometry.setAttribute('shape', Float32Array.from(attributes.instancedShapes), {\n        arrayStride: 4,\n        stepMode: 'instance',\n        attributes: [{\n          shaderLocation: 4,\n          offset: 0,\n          format: 'float'\n        }]\n      });\n      geometry.setAttribute('a_PickingColor', Float32Array.from(attributes.instancedPickingColors), {\n        arrayStride: 4 * 3,\n        stepMode: 'instance',\n        attributes: [{\n          shaderLocation: 6,\n          offset: 0,\n          format: 'float3'\n        }]\n      });\n      this.setMaterial(material);\n      this.setGeometry(geometry);\n    }\n  }, {\n    key: \"buildAttribute\",\n    value: function buildAttribute(config, attributes, index) {\n      var _attributes$instanced, _attributes$instanced2, _attributes$instanced3, _attributes$instanced4;\n\n      (_attributes$instanced = attributes.instancedPickingColors).push.apply(_attributes$instanced, (0, _toConsumableArray2.default)((0, _picking.encodePickingColor)(config.id || index)));\n\n      attributes.instancedShapes.push(pointShapes.indexOf(config.shape || 'circle'));\n\n      (_attributes$instanced2 = attributes.instancedColors).push.apply(_attributes$instanced2, (0, _toConsumableArray2.default)(config.color || [1, 0, 0, 1]));\n\n      (_attributes$instanced3 = attributes.instancedOffsets).push.apply(_attributes$instanced3, (0, _toConsumableArray2.default)(config.position || [0, 0]));\n\n      (_attributes$instanced4 = attributes.instancedSizes).push.apply(_attributes$instanced4, (0, _toConsumableArray2.default)(config.size || [0.2, 0.2]));\n    }\n  }, {\n    key: \"buildAttributes\",\n    value: function buildAttributes() {\n      var _this2 = this;\n\n      var attributes = {\n        positions: [1, 1, 1, -1, -1, -1, -1, 1],\n        instancedOffsets: [],\n        instancedColors: [],\n        instancedSizes: [],\n        instancedShapes: [],\n        instancedPickingColors: []\n      };\n\n      if (Array.isArray(this.config)) {\n        this.config.forEach(function (config, i) {\n          _this2.buildAttribute(config, attributes, i);\n        });\n      } else {\n        this.buildAttribute(this.config, attributes, 0);\n      }\n\n      return attributes;\n    }\n  }]);\n  return Point;\n}(_Renderable2.Renderable), _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"materialSystem\", [_dec2, _dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"geometrySystem\", [_dec4, _dec5], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"shaderModuleService\", [_dec6], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Point = Point;\n//# sourceMappingURL=index.js.map","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.encodePickingColor = encodePickingColor;\n\nfunction encodePickingColor(featureIdx) {\n  return [featureIdx + 1 & 255, featureIdx + 1 >> 8 & 255, featureIdx + 1 >> 8 >> 8 & 255];\n}\n//# sourceMappingURL=picking.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Renderer = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar WebGPUConstants = _interopRequireWildcard(require(\"@webgpu/types/dist/constants\"));\n\nvar _inversify = require(\"inversify\");\n\nvar _dec, _dec2, _dec3, _dec4, _class, _class2, _descriptor, _descriptor2, _descriptor3, _temp;\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n/* babel-plugin-inline-import './material/shaders/map.frag.declaration.glsl' */\nvar mapFragDeclaration = \"#ifdef USE_MAP\\n  uniform sampler2D map;\\n#endif\";\n\n/* babel-plugin-inline-import './material/shaders/map.frag.main.glsl' */\nvar mapFragMain = \"#ifdef USE_MAP\\n  vec4 texelColor = texture2D(map, vUv);\\n  // texelColor = mapTexelToLinear(texelColor);\\n  diffuseColor *= texelColor;\\n#endif\";\n\n/* babel-plugin-inline-import './material/shaders/uv.frag.declaration.glsl' */\nvar uvFragDeclaration = \"#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))\\n  varying vec2 vUv;\\n#endif\";\n\n/* babel-plugin-inline-import './material/shaders/uv.vert.declaration.glsl' */\nvar uvVertDeclaration = \"#ifdef USE_UV\\n  attribute vec2 uv;\\n\\t#ifdef UVS_VERTEX_ONLY\\n    vec2 vUv;\\n\\t#else\\n\\t\\tvarying vec2 vUv;\\n\\t#endif\\n\\tuniform mat3 uvTransform;\\n#endif\";\n\n/* babel-plugin-inline-import './material/shaders/uv.vert.main.glsl' */\nvar uvVertMain = \"#ifdef USE_UV\\n  vUv = (uvTransform * vec3(uv, 1)).xy;\\n#endif\";\nvar Renderer = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.RenderEngine), _dec3 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.ShaderModuleService), _dec4 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.ConfigService), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function () {\n  function Renderer() {\n    (0, _classCallCheck2.default)(this, Renderer);\n    this.container = void 0;\n    (0, _initializerDefineProperty2.default)(this, \"engine\", _descriptor, this);\n    (0, _initializerDefineProperty2.default)(this, \"shaderModule\", _descriptor2, this);\n    (0, _initializerDefineProperty2.default)(this, \"configService\", _descriptor3, this);\n    this.inited = false;\n    this.rendering = false;\n    this.pendings = [];\n    this.views = [];\n    this.size = void 0;\n  }\n\n  (0, _createClass2.default)(Renderer, [{\n    key: \"init\",\n    value: function () {\n      var _init = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n        var systems, config, _iterator, _step, system;\n\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // 模块化处理\n                this.shaderModule.registerBuiltinModules();\n                this.shaderModule.registerModule('uv.vert.declaration', {\n                  vs: uvVertDeclaration\n                });\n                this.shaderModule.registerModule('uv.vert.main', {\n                  vs: uvVertMain\n                });\n                this.shaderModule.registerModule('uv.frag.declaration', {\n                  fs: uvFragDeclaration\n                });\n                this.shaderModule.registerModule('map.frag.declaration', {\n                  fs: mapFragDeclaration\n                });\n                this.shaderModule.registerModule('map.frag.main', {\n                  fs: mapFragMain\n                });\n                systems = this.container.getAll(_gWebgpuCore.IDENTIFIER.Systems);\n                config = this.configService.get();\n\n                if (!config.canvas) {\n                  _context.next = 30;\n                  break;\n                }\n\n                _context.next = 11;\n                return this.engine.init({\n                  canvas: config.canvas,\n                  swapChainFormat: WebGPUConstants.TextureFormat.BGRA8Unorm,\n                  antialiasing: false\n                });\n\n              case 11:\n                _iterator = _createForOfIteratorHelper(systems);\n                _context.prev = 12;\n\n                _iterator.s();\n\n              case 14:\n                if ((_step = _iterator.n()).done) {\n                  _context.next = 21;\n                  break;\n                }\n\n                system = _step.value;\n\n                if (!system.initialize) {\n                  _context.next = 19;\n                  break;\n                }\n\n                _context.next = 19;\n                return system.initialize();\n\n              case 19:\n                _context.next = 14;\n                break;\n\n              case 21:\n                _context.next = 26;\n                break;\n\n              case 23:\n                _context.prev = 23;\n                _context.t0 = _context[\"catch\"](12);\n\n                _iterator.e(_context.t0);\n\n              case 26:\n                _context.prev = 26;\n\n                _iterator.f();\n\n                return _context.finish(26);\n\n              case 29:\n                this.inited = true;\n\n              case 30:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[12, 23, 26, 29]]);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"render\",\n    value: function () {\n      var _render = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n        var systems,\n            _len,\n            views,\n            _key,\n            _iterator2,\n            _step2,\n            system,\n            _args2 = arguments;\n\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(!this.inited || this.rendering)) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                if (this.pendings.length) {\n                  this.pendings.forEach(function (pending) {\n                    pending();\n                  });\n                }\n\n                this.rendering = true;\n                this.engine.beginFrame();\n                systems = this.container.getAll(_gWebgpuCore.IDENTIFIER.Systems);\n\n                for (_len = _args2.length, views = new Array(_len), _key = 0; _key < _len; _key++) {\n                  views[_key] = _args2[_key];\n                }\n\n                _iterator2 = _createForOfIteratorHelper(systems);\n                _context2.prev = 8;\n\n                _iterator2.s();\n\n              case 10:\n                if ((_step2 = _iterator2.n()).done) {\n                  _context2.next = 17;\n                  break;\n                }\n\n                system = _step2.value;\n\n                if (!system.execute) {\n                  _context2.next = 15;\n                  break;\n                }\n\n                _context2.next = 15;\n                return system.execute(views);\n\n              case 15:\n                _context2.next = 10;\n                break;\n\n              case 17:\n                _context2.next = 22;\n                break;\n\n              case 19:\n                _context2.prev = 19;\n                _context2.t0 = _context2[\"catch\"](8);\n\n                _iterator2.e(_context2.t0);\n\n              case 22:\n                _context2.prev = 22;\n\n                _iterator2.f();\n\n                return _context2.finish(22);\n\n              case 25:\n                // 录制一遍绘制命令，后续直接播放\n                // if (this.useRenderBundle) {\n                //   if (!this.renderBundleRecorded) {\n                //     this.engine.startRecordBundle();\n                //     if (this.onUpdate) {\n                //       await this.onUpdate(this.engine);\n                //     }\n                //     this.renderBundle = this.engine.stopRecordBundle();\n                //     this.renderBundleRecorded = true;\n                //   }\n                //   this.engine.executeBundles([this.renderBundle]);\n                // } else {\n                //   if (this.onUpdate) {\n                //     await this.onUpdate(this.engine);\n                //   }\n                // }\n                this.engine.endFrame();\n                this.rendering = false;\n\n              case 27:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[8, 19, 22, 25]]);\n      }));\n\n      function render() {\n        return _render.apply(this, arguments);\n      }\n\n      return render;\n    }()\n  }, {\n    key: \"clear\",\n    value: function clear(options) {\n      var _this = this;\n\n      if (this.inited) {\n        this.engine.clear(options);\n      } else {\n        this.pendings.unshift(function () {\n          _this.engine.clear(options);\n\n          _this.pendings.shift();\n        });\n      }\n\n      return this;\n    } // public setScissor(\n    //   scissor: Partial<{\n    //     enable: boolean;\n    //     box: {\n    //       x: number;\n    //       y: number;\n    //       width: number;\n    //       height: number;\n    //     };\n    //   }>,\n    // ) {\n    //   this.engine.setScissor(scissor);\n    //   return this;\n    // }\n\n  }, {\n    key: \"setSize\",\n    value: function setSize(_ref) {\n      var width = _ref.width,\n          height = _ref.height;\n      var canvas = this.engine.getCanvas();\n      this.size = {\n        width: width,\n        height: height\n      };\n      canvas.width = width;\n      canvas.height = height;\n      return this;\n    }\n  }, {\n    key: \"getSize\",\n    value: function getSize() {\n      return this.size;\n    }\n  }]);\n  return Renderer;\n}(), _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"engine\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"shaderModule\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"configService\", [_dec4], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Renderer = Renderer;\n//# sourceMappingURL=Renderer.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Scene = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inversify = require(\"inversify\");\n\nvar _dec, _class, _temp;\n\nvar Scene = (_dec = (0, _inversify.injectable)(), _dec(_class = (_temp = /*#__PURE__*/function () {\n  function Scene() {\n    (0, _classCallCheck2.default)(this, Scene);\n    this.entities = [];\n  }\n\n  (0, _createClass2.default)(Scene, [{\n    key: \"getEntities\",\n    value: function getEntities() {\n      return this.entities;\n    }\n  }, {\n    key: \"addRenderable\",\n    value: function addRenderable(renderable) {\n      this.addEntity(renderable.getEntity());\n      return this;\n    }\n  }, {\n    key: \"removeRenderable\",\n    value: function removeRenderable(renderable) {\n      this.removeEntity(renderable.getEntity());\n      return this;\n    }\n  }, {\n    key: \"addLight\",\n    value: function addLight() {}\n  }, {\n    key: \"addEntity\",\n    value: function addEntity(entity) {\n      if (this.entities.indexOf(entity) === -1) {\n        this.entities.push(entity);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"removeEntity\",\n    value: function removeEntity(entity) {\n      var index = this.entities.indexOf(entity);\n      this.entities.splice(index, 1);\n      return this;\n    }\n  }]);\n  return Scene;\n}(), _temp)) || _class);\nexports.Scene = Scene;\n//# sourceMappingURL=Scene.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TextureCache = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inversify = require(\"inversify\");\n\nvar _dec, _class, _temp;\n\nvar TextureCache = (_dec = (0, _inversify.injectable)(), _dec(_class = (_temp = /*#__PURE__*/function () {\n  function TextureCache() {\n    (0, _classCallCheck2.default)(this, TextureCache);\n    this.cache = {};\n  }\n\n  (0, _createClass2.default)(TextureCache, [{\n    key: \"get\",\n    value: function get(name) {\n      return this.cache[name];\n    }\n  }, {\n    key: \"set\",\n    value: function set(name, texture) {\n      this.cache[name] = texture;\n    }\n  }]);\n  return TextureCache;\n}(), _temp)) || _class);\nexports.TextureCache = TextureCache;\n//# sourceMappingURL=Cache.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Texture2D = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _Cache = require(\"./Cache\");\n\nvar _dec, _dec2, _dec3, _class, _class2, _descriptor, _descriptor2, _temp;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar Texture2D = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_Cache.TextureCache), _dec3 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.RenderEngine), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function () {\n  function Texture2D() {\n    (0, _classCallCheck2.default)(this, Texture2D);\n    (0, _initializerDefineProperty2.default)(this, \"textureCache\", _descriptor, this);\n    (0, _initializerDefineProperty2.default)(this, \"engine\", _descriptor2, this);\n    this.config = void 0;\n    this.loaded = false;\n    this.texture = void 0;\n  }\n\n  (0, _createClass2.default)(Texture2D, [{\n    key: \"setConfig\",\n    value: function setConfig(config) {\n      this.config = config;\n    }\n  }, {\n    key: \"isLoaded\",\n    value: function isLoaded() {\n      return this.loaded;\n    } // public update(config: ITexture2DInitializationOptions) {\n    //   if (this.loaded && this.texture) {\n    //     const t = this.texture.get();\n    //   }\n    // }\n\n  }, {\n    key: \"load\",\n    value: function () {\n      var _load = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n        var _this = this;\n\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!this.config.url) {\n                  _context.next = 4;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n                  var existed = _this.textureCache.get(_this.config.url);\n\n                  if (existed) {\n                    resolve(existed);\n                  } else {\n                    var image = new Image();\n                    image.crossOrigin = 'Anonymous';\n                    image.src = _this.config.url;\n\n                    image.onload = function () {\n                      var texture = _this.engine.createTexture2D(_objectSpread(_objectSpread({}, _this.config), {}, {\n                        data: image,\n                        width: image.width,\n                        height: image.height,\n                        flipY: true\n                      }));\n\n                      _this.textureCache.set(_this.config.url, texture);\n\n                      _this.texture = texture;\n                      _this.loaded = true;\n                      resolve(texture);\n                    };\n\n                    image.onerror = function () {\n                      reject();\n                    };\n                  }\n                }));\n\n              case 4:\n                this.loaded = true;\n                this.texture = this.engine.createTexture2D(this.config);\n                return _context.abrupt(\"return\", this.texture);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function load() {\n        return _load.apply(this, arguments);\n      }\n\n      return load;\n    }()\n  }]);\n  return Texture2D;\n}(), _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"textureCache\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"engine\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.Texture2D = Texture2D;\n//# sourceMappingURL=Texture2D.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.View = void 0;\n\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\n\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\n\nvar _gWebgpuCore = require(\"@antv/g-webgpu-core\");\n\nvar _inversify = require(\"inversify\");\n\nvar _dec, _dec2, _dec3, _class, _class2, _descriptor, _temp;\n\nvar View = (_dec = (0, _inversify.injectable)(), _dec2 = (0, _inversify.inject)(_gWebgpuCore.IDENTIFIER.Systems), _dec3 = (0, _inversify.named)(_gWebgpuCore.IDENTIFIER.RendererSystem), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function () {\n  function View() {\n    (0, _classCallCheck2.default)(this, View);\n    (0, _initializerDefineProperty2.default)(this, \"rendererSystem\", _descriptor, this);\n    this.camera = void 0;\n    this.scene = void 0;\n    this.viewport = {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    };\n    this.clearColor = [1, 1, 1, 1];\n  }\n\n  (0, _createClass2.default)(View, [{\n    key: \"getCamera\",\n    value: function getCamera() {\n      return this.camera;\n    }\n  }, {\n    key: \"getScene\",\n    value: function getScene() {\n      return this.scene;\n    }\n  }, {\n    key: \"getViewport\",\n    value: function getViewport() {\n      return this.viewport;\n    }\n  }, {\n    key: \"getClearColor\",\n    value: function getClearColor() {\n      return this.clearColor;\n    }\n  }, {\n    key: \"setCamera\",\n    value: function setCamera(camera) {\n      this.camera = camera;\n      return this;\n    }\n  }, {\n    key: \"setScene\",\n    value: function setScene(scene) {\n      this.scene = scene;\n      return this;\n    }\n  }, {\n    key: \"setViewport\",\n    value: function setViewport(viewport) {\n      this.viewport = viewport;\n      return this;\n    }\n  }, {\n    key: \"setClearColor\",\n    value: function setClearColor(clearColor) {\n      this.clearColor = clearColor;\n      return this;\n    }\n  }, {\n    key: \"pick\",\n    value: function pick(position) {\n      return this.rendererSystem.pick(position, this);\n    }\n  }]);\n  return View;\n}(), _temp), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class2.prototype, \"rendererSystem\", [_dec2, _dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);\nexports.View = View;\n//# sourceMappingURL=View.js.map"]}