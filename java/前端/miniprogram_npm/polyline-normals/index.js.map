{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["var util = require('polyline-miter-util')\n\nvar lineA = [0, 0]\nvar lineB = [0, 0]\nvar tangent = [0, 0]\nvar miter = [0, 0]\n\nmodule.exports = function(points, closed) {\n    var curNormal = null\n    var out = []\n    if (closed) {\n        points = points.slice()\n        points.push(points[0])\n    }\n\n    var total = points.length\n    for (var i=1; i<total; i++) {\n        var last = points[i-1]\n        var cur = points[i]\n        var next = i<points.length-1 ? points[i+1] : null\n\n        util.direction(lineA, cur, last)\n        if (!curNormal)  {\n            curNormal = [0, 0]\n            util.normal(curNormal, lineA)\n        }\n\n        if (i === 1) //add initial normals\n            addNext(out, curNormal, 1)\n\n        if (!next) { //no miter, simple segment\n            util.normal(curNormal, lineA) //reset normal\n            addNext(out, curNormal, 1)\n        } else { //miter with last\n            //get unit dir of next line\n            util.direction(lineB, next, cur)\n\n            //stores tangent & miter\n            var miterLen = util.computeMiter(tangent, miter, lineA, lineB, 1)\n            addNext(out, miter, miterLen)\n        }\n    }\n\n    //if the polyline is a closed loop, clean up the last normal\n    if (points.length > 2 && closed) {\n        var last2 = points[total-2]\n        var cur2 = points[0]\n        var next2 = points[1]\n\n        util.direction(lineA, cur2, last2)\n        util.direction(lineB, next2, cur2)\n        util.normal(curNormal, lineA)\n        \n        var miterLen2 = util.computeMiter(tangent, miter, lineA, lineB, 1)\n        out[0][0] = miter.slice()\n        out[total-1][0] = miter.slice()\n        out[0][1] = miterLen2\n        out[total-1][1] = miterLen2\n        out.pop()\n    }\n\n    return out\n}\n\nfunction addNext(out, normal, length) {\n    out.push([[normal[0], normal[1]], length])\n}"]}