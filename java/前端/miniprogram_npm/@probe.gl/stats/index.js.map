{"version":3,"sources":["index.js","lib/stats.js","lib/stat.js","utils/hi-res-timestamp.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA,ACHA;ADIA,ACHA;ADIA,ACHA;ADIA,AENA,ADGA;ADIA,AENA,ADGA;ADIA,AENA,ADGA;ADIA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA,AENA;AHUA,AENA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"Stat\", {\n  enumerable: true,\n  get: function get() {\n    return _stat.default;\n  }\n});\nObject.defineProperty(exports, \"Stats\", {\n  enumerable: true,\n  get: function get() {\n    return _stats.default;\n  }\n});\nObject.defineProperty(exports, \"_getHiResTimestamp\", {\n  enumerable: true,\n  get: function get() {\n    return _hiResTimestamp.default;\n  }\n});\n\nvar _stats = _interopRequireDefault(require(\"./lib/stats\"));\n\nvar _stat = _interopRequireDefault(require(\"./lib/stat\"));\n\nvar _hiResTimestamp = _interopRequireDefault(require(\"./utils/hi-res-timestamp\"));\n//# sourceMappingURL=index.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _stat = _interopRequireDefault(require(\"./stat\"));\n\nvar Stats = function () {\n  function Stats(options) {\n    (0, _classCallCheck2.default)(this, Stats);\n    (0, _defineProperty2.default)(this, \"id\", void 0);\n    (0, _defineProperty2.default)(this, \"stats\", {});\n    this.id = options.id;\n    this.stats = {};\n\n    this._initializeStats(options.stats);\n\n    Object.seal(this);\n  }\n\n  (0, _createClass2.default)(Stats, [{\n    key: \"get\",\n    value: function get(name) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'count';\n      return this._getOrCreate({\n        name: name,\n        type: type\n      });\n    }\n  }, {\n    key: \"size\",\n    get: function get() {\n      return Object.keys(this.stats).length;\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      for (var key in this.stats) {\n        this.stats[key].reset();\n      }\n\n      return this;\n    }\n  }, {\n    key: \"forEach\",\n    value: function forEach(fn) {\n      for (var key in this.stats) {\n        fn(this.stats[key]);\n      }\n    }\n  }, {\n    key: \"getTable\",\n    value: function getTable() {\n      var table = {};\n      this.forEach(function (stat) {\n        table[stat.name] = {\n          time: stat.time || 0,\n          count: stat.count || 0,\n          average: stat.getAverageTime() || 0,\n          hz: stat.getHz() || 0\n        };\n      });\n      return table;\n    }\n  }, {\n    key: \"_initializeStats\",\n    value: function _initializeStats() {\n      var _this = this;\n\n      var stats = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      stats.forEach(function (stat) {\n        return _this._getOrCreate(stat);\n      });\n    }\n  }, {\n    key: \"_getOrCreate\",\n    value: function _getOrCreate(stat) {\n      if (!stat || !stat.name) {\n        return null;\n      }\n\n      var name = stat.name,\n          type = stat.type;\n\n      if (!this.stats[name]) {\n        if (stat instanceof _stat.default) {\n          this.stats[name] = stat;\n        } else {\n          this.stats[name] = new _stat.default(name, type);\n        }\n      }\n\n      return this.stats[name];\n    }\n  }]);\n  return Stats;\n}();\n\nexports.default = Stats;\n//# sourceMappingURL=stats.js.map","\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _hiResTimestamp = _interopRequireDefault(require(\"../utils/hi-res-timestamp\"));\n\nvar Stat = function () {\n  function Stat(name, type) {\n    (0, _classCallCheck2.default)(this, Stat);\n    (0, _defineProperty2.default)(this, \"name\", void 0);\n    (0, _defineProperty2.default)(this, \"type\", void 0);\n    (0, _defineProperty2.default)(this, \"sampleSize\", 1);\n    (0, _defineProperty2.default)(this, \"time\", void 0);\n    (0, _defineProperty2.default)(this, \"count\", void 0);\n    (0, _defineProperty2.default)(this, \"samples\", void 0);\n    (0, _defineProperty2.default)(this, \"lastTiming\", void 0);\n    (0, _defineProperty2.default)(this, \"lastSampleTime\", void 0);\n    (0, _defineProperty2.default)(this, \"lastSampleCount\", void 0);\n    (0, _defineProperty2.default)(this, \"_count\", 0);\n    (0, _defineProperty2.default)(this, \"_time\", 0);\n    (0, _defineProperty2.default)(this, \"_samples\", 0);\n    (0, _defineProperty2.default)(this, \"_startTime\", 0);\n    (0, _defineProperty2.default)(this, \"_timerPending\", false);\n    this.name = name;\n    this.type = type;\n    this.reset();\n  }\n\n  (0, _createClass2.default)(Stat, [{\n    key: \"setSampleSize\",\n    value: function setSampleSize(samples) {\n      this.sampleSize = samples;\n      return this;\n    }\n  }, {\n    key: \"incrementCount\",\n    value: function incrementCount() {\n      this.addCount(1);\n      return this;\n    }\n  }, {\n    key: \"decrementCount\",\n    value: function decrementCount() {\n      this.subtractCount(1);\n      return this;\n    }\n  }, {\n    key: \"addCount\",\n    value: function addCount(value) {\n      this._count += value;\n      this._samples++;\n\n      this._checkSampling();\n\n      return this;\n    }\n  }, {\n    key: \"subtractCount\",\n    value: function subtractCount(value) {\n      this._count -= value;\n      this._samples++;\n\n      this._checkSampling();\n\n      return this;\n    }\n  }, {\n    key: \"addTime\",\n    value: function addTime(time) {\n      this._time += time;\n      this.lastTiming = time;\n      this._samples++;\n\n      this._checkSampling();\n\n      return this;\n    }\n  }, {\n    key: \"timeStart\",\n    value: function timeStart() {\n      this._startTime = (0, _hiResTimestamp.default)();\n      this._timerPending = true;\n      return this;\n    }\n  }, {\n    key: \"timeEnd\",\n    value: function timeEnd() {\n      if (!this._timerPending) {\n        return this;\n      }\n\n      this.addTime((0, _hiResTimestamp.default)() - this._startTime);\n      this._timerPending = false;\n\n      this._checkSampling();\n\n      return this;\n    }\n  }, {\n    key: \"getSampleAverageCount\",\n    value: function getSampleAverageCount() {\n      return this.sampleSize > 0 ? this.lastSampleCount / this.sampleSize : 0;\n    }\n  }, {\n    key: \"getSampleAverageTime\",\n    value: function getSampleAverageTime() {\n      return this.sampleSize > 0 ? this.lastSampleTime / this.sampleSize : 0;\n    }\n  }, {\n    key: \"getSampleHz\",\n    value: function getSampleHz() {\n      return this.lastSampleTime > 0 ? this.sampleSize / (this.lastSampleTime / 1000) : 0;\n    }\n  }, {\n    key: \"getAverageCount\",\n    value: function getAverageCount() {\n      return this.samples > 0 ? this.count / this.samples : 0;\n    }\n  }, {\n    key: \"getAverageTime\",\n    value: function getAverageTime() {\n      return this.samples > 0 ? this.time / this.samples : 0;\n    }\n  }, {\n    key: \"getHz\",\n    value: function getHz() {\n      return this.time > 0 ? this.samples / (this.time / 1000) : 0;\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.time = 0;\n      this.count = 0;\n      this.samples = 0;\n      this.lastTiming = 0;\n      this.lastSampleTime = 0;\n      this.lastSampleCount = 0;\n      this._count = 0;\n      this._time = 0;\n      this._samples = 0;\n      this._startTime = 0;\n      this._timerPending = false;\n      return this;\n    }\n  }, {\n    key: \"_checkSampling\",\n    value: function _checkSampling() {\n      if (this._samples === this.sampleSize) {\n        this.lastSampleTime = this._time;\n        this.lastSampleCount = this._count;\n        this.count += this._count;\n        this.time += this._time;\n        this.samples += this._samples;\n        this._time = 0;\n        this._count = 0;\n        this._samples = 0;\n      }\n    }\n  }]);\n  return Stat;\n}();\n\nexports.default = Stat;\n//# sourceMappingURL=stat.js.map","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = getHiResTimestamp;\n\nfunction getHiResTimestamp() {\n  var timestamp;\n\n  if (typeof window !== 'undefined' && window.performance) {\n    timestamp = window.performance.now();\n  } else if (typeof process !== 'undefined' && process.hrtime) {\n    var timeParts = process.hrtime();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n//# sourceMappingURL=hi-res-timestamp.js.map"]}